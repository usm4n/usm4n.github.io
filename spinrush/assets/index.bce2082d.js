var ns=Object.defineProperty;var ss=(r,a,u)=>a in r?ns(r,a,{enumerable:!0,configurable:!0,writable:!0,value:u}):r[a]=u;var y=(r,a,u)=>(ss(r,typeof a!="symbol"?a+"":a,u),u);(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const w of document.querySelectorAll('link[rel="modulepreload"]'))l(w);new MutationObserver(w=>{for(const p of w)if(p.type==="childList")for(const S of p.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&l(S)}).observe(document,{childList:!0,subtree:!0});function u(w){const p={};return w.integrity&&(p.integrity=w.integrity),w.referrerpolicy&&(p.referrerPolicy=w.referrerpolicy),w.crossorigin==="use-credentials"?p.credentials="include":w.crossorigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function l(w){if(w.ep)return;w.ep=!0;const p=u(w);fetch(w.href,p)}})();var Sn=Object.defineProperty,os=(r,a,u)=>a in r?Sn(r,a,{enumerable:!0,configurable:!0,writable:!0,value:u}):r[a]=u,o=(r,a)=>Sn(r,"name",{value:a,configurable:!0}),st=(r,a,u)=>(os(r,typeof a!="symbol"?a+"":a,u),u),as=(()=>{for(var r=new Uint8Array(128),a=0;a<64;a++)r[a<26?a+65:a<52?a+71:a<62?a-4:a*4-205]=a;return u=>{for(var l=u.length,w=new Uint8Array((l-(u[l-1]=="=")-(u[l-2]=="="))*3/4|0),p=0,S=0;p<l;){var R=r[u.charCodeAt(p++)],B=r[u.charCodeAt(p++)],F=r[u.charCodeAt(p++)],D=r[u.charCodeAt(p++)];w[S++]=R<<2|B>>4,w[S++]=B<<4|F>>2,w[S++]=F<<6|D}return w}})();function Et(r){return r*Math.PI/180}o(Et,"deg2rad");function Fr(r){return r*180/Math.PI}o(Fr,"rad2deg");function ot(r,a,u){return a>u?ot(r,u,a):Math.min(Math.max(r,a),u)}o(ot,"clamp");function ie(r,a,u){return r+(a-r)*u}o(ie,"lerp");function Fe(r,a,u,l,w){return l+(r-a)/(u-a)*(w-l)}o(Fe,"map");function Rn(r,a,u,l,w){return ot(Fe(r,a,u,l,w),l,w)}o(Rn,"mapc");var H=class{constructor(r=0,a=r){y(this,"x",0);y(this,"y",0);this.x=r,this.y=a}static fromAngle(r){let a=Et(r);return new H(Math.cos(a),Math.sin(a))}clone(){return new H(this.x,this.y)}add(...r){let a=g(...r);return new H(this.x+a.x,this.y+a.y)}sub(...r){let a=g(...r);return new H(this.x-a.x,this.y-a.y)}scale(...r){let a=g(...r);return new H(this.x*a.x,this.y*a.y)}dist(...r){let a=g(...r);return Math.sqrt((this.x-a.x)*(this.x-a.x)+(this.y-a.y)*(this.y-a.y))}len(){return this.dist(new H(0,0))}unit(){let r=this.len();return r===0?new H(0):this.scale(1/r)}normal(){return new H(this.y,-this.x)}dot(r){return this.x*r.x+this.y*r.y}angle(...r){let a=g(...r);return Fr(Math.atan2(this.y-a.y,this.x-a.x))}lerp(r,a){return new H(ie(this.x,r.x,a),ie(this.y,r.y,a))}isZero(){return this.x===0&&this.y===0}toFixed(r){return new H(Number(this.x.toFixed(r)),Number(this.y.toFixed(r)))}eq(r){return this.x===r.x&&this.y===r.y}toString(){return`vec2(${this.x.toFixed(2)}, ${this.y.toFixed(2)})`}},L=H;o(L,"Vec2"),st(L,"LEFT",new H(-1,0)),st(L,"RIGHT",new H(1,0)),st(L,"UP",new H(0,-1)),st(L,"DOWN",new H(0,1));function g(...r){if(r.length===1){if(r[0]instanceof L)return g(r[0].x,r[0].y);if(Array.isArray(r[0])&&r[0].length===2)return g(...r[0])}return new L(...r)}o(g,"vec2");var Cr=class{constructor(r,a,u){y(this,"x",0);y(this,"y",0);y(this,"z",0);this.x=r,this.y=a,this.z=u}xy(){return g(this.x,this.y)}};o(Cr,"Vec3");var Bt=o((r,a,u)=>new Cr(r,a,u),"vec3"),Ft=class{constructor(r,a,u){y(this,"r",255);y(this,"g",255);y(this,"b",255);this.r=ot(r,0,255),this.g=ot(a,0,255),this.b=ot(u,0,255)}static fromArray(r){return new Ft(r[0],r[1],r[2])}clone(){return new Ft(this.r,this.g,this.b)}lighten(r){return new Ft(this.r+r,this.g+r,this.b+r)}darken(r){return this.lighten(-r)}invert(){return new Ft(255-this.r,255-this.g,255-this.b)}mult(r){return new Ft(this.r*r.r/255,this.g*r.g/255,this.b*r.b/255)}eq(r){return this.r===r.r&&this.g===r.g&&this.b===r.b}toString(){return`rgb(${this.r}, ${this.g}, ${this.b})`}static fromHSL(r,a,u){if(a==0)return T(255*u,255*u,255*u);let l=o((F,D,x)=>(x<0&&(x+=1),x>1&&(x-=1),x<1/6?F+(D-F)*6*x:x<1/2?D:x<2/3?F+(D-F)*(2/3-x)*6:F),"hue2rgb"),w=u<.5?u*(1+a):u+a-u*a,p=2*u-w,S=l(p,w,r+1/3),R=l(p,w,r),B=l(p,w,r-1/3);return new Ft(Math.round(S*255),Math.round(R*255),Math.round(B*255))}},I=Ft;o(I,"Color"),st(I,"RED",T(255,0,0)),st(I,"GREEN",T(0,255,0)),st(I,"BLUE",T(0,0,255)),st(I,"YELLOW",T(255,255,0)),st(I,"MAGENTA",T(255,0,255)),st(I,"CYAN",T(0,255,255)),st(I,"WHITE",T(255,255,255)),st(I,"BLACK",T(0,0,0));function T(...r){if(r.length===0)return new I(255,255,255);if(r.length===1){if(r[0]instanceof I)return r[0].clone();if(Array.isArray(r[0])&&r[0].length===3)return I.fromArray(r[0])}return new I(...r)}o(T,"rgb");var us=o((r,a,u)=>I.fromHSL(r,a,u),"hsl2rgb"),O=class{constructor(r,a,u,l){y(this,"x",0);y(this,"y",0);y(this,"w",1);y(this,"h",1);this.x=r,this.y=a,this.w=u,this.h=l}scale(r){return new O(this.x+this.w*r.x,this.y+this.h*r.y,this.w*r.w,this.h*r.h)}clone(){return new O(this.x,this.y,this.w,this.h)}eq(r){return this.x===r.x&&this.y===r.y&&this.w===r.w&&this.h===r.h}toString(){return`quad(${this.x}, ${this.y}, ${this.w}, ${this.h})`}};o(O,"Quad");function Bn(r,a,u,l){return new O(r,a,u,l)}o(Bn,"quad");var P=class{constructor(r){y(this,"m",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);r&&(this.m=r)}static translate(r){return new P([1,0,0,0,0,1,0,0,0,0,1,0,r.x,r.y,0,1])}static scale(r){return new P([r.x,0,0,0,0,r.y,0,0,0,0,1,0,0,0,0,1])}static rotateX(r){return r=Et(-r),new P([1,0,0,0,0,Math.cos(r),-Math.sin(r),0,0,Math.sin(r),Math.cos(r),0,0,0,0,1])}static rotateY(r){return r=Et(-r),new P([Math.cos(r),0,Math.sin(r),0,0,1,0,0,-Math.sin(r),0,Math.cos(r),0,0,0,0,1])}static rotateZ(r){return r=Et(-r),new P([Math.cos(r),-Math.sin(r),0,0,Math.sin(r),Math.cos(r),0,0,0,0,1,0,0,0,0,1])}translate(r){return this.mult(P.translate(r))}scale(r){return this.mult(P.scale(r))}rotateX(r){return this.mult(P.rotateX(r))}rotateY(r){return this.mult(P.rotateY(r))}rotateZ(r){return this.mult(P.rotateZ(r))}mult(r){let a=[];for(let u=0;u<4;u++)for(let l=0;l<4;l++)a[u*4+l]=this.m[0*4+l]*r.m[u*4+0]+this.m[1*4+l]*r.m[u*4+1]+this.m[2*4+l]*r.m[u*4+2]+this.m[3*4+l]*r.m[u*4+3];return new P(a)}multVec4(r){return{x:r.x*this.m[0]+r.y*this.m[4]+r.z*this.m[8]+r.w*this.m[12],y:r.x*this.m[1]+r.y*this.m[5]+r.z*this.m[9]+r.w*this.m[13],z:r.x*this.m[2]+r.y*this.m[6]+r.z*this.m[10]+r.w*this.m[14],w:r.x*this.m[3]+r.y*this.m[7]+r.z*this.m[11]+r.w*this.m[15]}}multVec3(r){let a=this.multVec4({x:r.x,y:r.y,z:r.z,w:1});return Bt(a.x,a.y,a.z)}multVec2(r){return g(r.x*this.m[0]+r.y*this.m[4]+0*this.m[8]+1*this.m[12],r.x*this.m[1]+r.y*this.m[5]+0*this.m[9]+1*this.m[13])}invert(){let r=[],a=this.m[10]*this.m[15]-this.m[14]*this.m[11],u=this.m[9]*this.m[15]-this.m[13]*this.m[11],l=this.m[9]*this.m[14]-this.m[13]*this.m[10],w=this.m[8]*this.m[15]-this.m[12]*this.m[11],p=this.m[8]*this.m[14]-this.m[12]*this.m[10],S=this.m[8]*this.m[13]-this.m[12]*this.m[9],R=this.m[6]*this.m[15]-this.m[14]*this.m[7],B=this.m[5]*this.m[15]-this.m[13]*this.m[7],F=this.m[5]*this.m[14]-this.m[13]*this.m[6],D=this.m[4]*this.m[15]-this.m[12]*this.m[7],x=this.m[4]*this.m[14]-this.m[12]*this.m[6],m=this.m[5]*this.m[15]-this.m[13]*this.m[7],G=this.m[4]*this.m[13]-this.m[12]*this.m[5],C=this.m[6]*this.m[11]-this.m[10]*this.m[7],$=this.m[5]*this.m[11]-this.m[9]*this.m[7],j=this.m[5]*this.m[10]-this.m[9]*this.m[6],tt=this.m[4]*this.m[11]-this.m[8]*this.m[7],yt=this.m[4]*this.m[10]-this.m[8]*this.m[6],xt=this.m[4]*this.m[9]-this.m[8]*this.m[5];r[0]=this.m[5]*a-this.m[6]*u+this.m[7]*l,r[4]=-(this.m[4]*a-this.m[6]*w+this.m[7]*p),r[8]=this.m[4]*u-this.m[5]*w+this.m[7]*S,r[12]=-(this.m[4]*l-this.m[5]*p+this.m[6]*S),r[1]=-(this.m[1]*a-this.m[2]*u+this.m[3]*l),r[5]=this.m[0]*a-this.m[2]*w+this.m[3]*p,r[9]=-(this.m[0]*u-this.m[1]*w+this.m[3]*S),r[13]=this.m[0]*l-this.m[1]*p+this.m[2]*S,r[2]=this.m[1]*R-this.m[2]*B+this.m[3]*F,r[6]=-(this.m[0]*R-this.m[2]*D+this.m[3]*x),r[10]=this.m[0]*m-this.m[1]*D+this.m[3]*G,r[14]=-(this.m[0]*F-this.m[1]*x+this.m[2]*G),r[3]=-(this.m[1]*C-this.m[2]*$+this.m[3]*j),r[7]=this.m[0]*C-this.m[2]*tt+this.m[3]*yt,r[11]=-(this.m[0]*$-this.m[1]*tt+this.m[3]*xt),r[15]=this.m[0]*j-this.m[1]*yt+this.m[2]*xt;let lt=this.m[0]*r[0]+this.m[1]*r[4]+this.m[2]*r[8]+this.m[3]*r[12];for(let It=0;It<4;It++)for(let ft=0;ft<4;ft++)r[It*4+ft]*=1/lt;return new P(r)}clone(){return new P(this.m)}toString(){return this.m.toString()}};o(P,"Mat4");function vr(r,a,u,l=Math.sin){return r+(l(u)+1)/2*(a-r)}o(vr,"wave");var ls=1103515245,hs=12345,An=2147483648,Tr=class{constructor(r){y(this,"seed");this.seed=r}gen(){return this.seed=(ls*this.seed+hs)%An,this.seed/An}genNumber(r,a){return r+this.gen()*(a-r)}genVec2(r,a){return new L(this.genNumber(r.x,a.x),this.genNumber(r.y,a.y))}genColor(r,a){return new I(this.genNumber(r.r,a.r),this.genNumber(r.g,a.g),this.genNumber(r.b,a.b))}genAny(...r){if(r.length===0)return this.gen();if(r.length===1){if(typeof r[0]=="number")return this.genNumber(0,r[0]);if(r[0]instanceof L)return this.genVec2(g(0,0),r[0]);if(r[0]instanceof I)return this.genColor(T(0,0,0),r[0])}else if(r.length===2){if(typeof r[0]=="number"&&typeof r[1]=="number")return this.genNumber(r[0],r[1]);if(r[0]instanceof L&&r[1]instanceof L)return this.genVec2(r[0],r[1]);if(r[0]instanceof I&&r[1]instanceof I)return this.genColor(r[0],r[1])}}};o(Tr,"RNG");var br=new Tr(Date.now());function Fn(r){return r!=null&&(br.seed=r),br.seed}o(Fn,"randSeed");function ne(...r){return br.genAny(...r)}o(ne,"rand");function Ir(...r){return Math.floor(ne(...r))}o(Ir,"randi");function Cn(r){return ne()<=r}o(Cn,"chance");function Tn(r){return r[Ir(r.length)]}o(Tn,"choose");function In(r,a){return r.pos.x+r.width>=a.pos.x&&r.pos.x<=a.pos.x+a.width&&r.pos.y+r.height>=a.pos.y&&r.pos.y<=a.pos.y+a.height}o(In,"testRectRect2");function Un(r,a){return r.pos.x+r.width>a.pos.x&&r.pos.x<a.pos.x+a.width&&r.pos.y+r.height>a.pos.y&&r.pos.y<a.pos.y+a.height}o(Un,"testRectRect");function Mn(r,a){if(r.p1.x===r.p2.x&&r.p1.y===r.p2.y||a.p1.x===a.p2.x&&a.p1.y===a.p2.y)return null;let u=(a.p2.y-a.p1.y)*(r.p2.x-r.p1.x)-(a.p2.x-a.p1.x)*(r.p2.y-r.p1.y);if(u===0)return null;let l=((a.p2.x-a.p1.x)*(r.p1.y-a.p1.y)-(a.p2.y-a.p1.y)*(r.p1.x-a.p1.x))/u,w=((r.p2.x-r.p1.x)*(r.p1.y-a.p1.y)-(r.p2.y-r.p1.y)*(r.p1.x-a.p1.x))/u;return l<0||l>1||w<0||w>1?null:l}o(Mn,"testLineLineT");function qt(r,a){let u=Mn(r,a);return u?g(r.p1.x+u*(r.p2.x-r.p1.x),r.p1.y+u*(r.p2.y-r.p1.y)):null}o(qt,"testLineLine");function Pn(r,a){if(Ce(r,Tt.fromVec2(a.p1))||Ce(r,Tt.fromVec2(a.p2)))return!0;let u=r.points();return!!qt(a,new Ct(u[0],u[1]))||!!qt(a,new Ct(u[1],u[2]))||!!qt(a,new Ct(u[2],u[3]))||!!qt(a,new Ct(u[3],u[0]))}o(Pn,"testRectLine");function Ce(r,a){return a.x>r.pos.x&&a.x<r.pos.x+r.width&&a.y>r.pos.y&&a.y<r.pos.y+r.height}o(Ce,"testRectPoint");function Dn(r,a){let u=!1,l=r.pts;for(let w=0,p=l.length-1;w<l.length;p=w++)l[w].y>a.y!=l[p].y>a.y&&a.x<(l[p].x-l[w].x)*(a.y-l[w].y)/(l[p].y-l[w].y)+l[w].x&&(u=!u);return u}o(Dn,"testPolygonPoint");var Ct=class{constructor(r,a){y(this,"p1");y(this,"p2");this.p1=r,this.p2=a}transform(r){return new Ct(r.multVec2(this.p1),r.multVec2(this.p2))}bbox(){return J.fromPoints(this.p1,this.p2)}};o(Ct,"Line");var J=class{constructor(r,a,u){y(this,"pos");y(this,"width");y(this,"height");this.pos=r,this.width=a,this.height=u}static fromPoints(r,a){return new J(r.clone(),a.x-r.x,a.y-r.y)}center(){return new L(this.pos.x+this.width/2,this.pos.y+this.height/2)}points(){return[this.pos,this.pos.add(this.width,0),this.pos.add(this.width,this.height),this.pos.add(0,this.height)]}transform(r){return new se(this.points().map(a=>r.multVec2(a)))}bbox(){return new J(this.pos.clone(),this.width,this.height)}};o(J,"Rect");var Se=class{constructor(r,a){y(this,"center");y(this,"radius");this.center=r,this.radius=a}transform(r){return new Ur(this.center,this.radius,this.radius).transform(r)}bbox(){return J.fromPoints(this.center.sub(g(this.radius)),this.center.add(g(this.radius)))}};o(Se,"Circle");var Ur=class{constructor(r,a,u){y(this,"center");y(this,"radiusX");y(this,"radiusY");this.center=r,this.radiusX=a,this.radiusY=u}transform(r){return new Ur(r.multVec2(this.center),r.m[0]*this.radiusX,r.m[5]*this.radiusY)}bbox(){return J.fromPoints(this.center.sub(g(this.radiusX,this.radiusY)),this.center.add(g(this.radiusX,this.radiusY)))}};o(Ur,"Ellipse");var se=class{constructor(r){y(this,"pts");if(r.length<3)throw new Error("Polygons should have at least 3 vertices");this.pts=r}transform(r){return new se(this.pts.map(a=>r.multVec2(a)))}bbox(){let r=g(Number.MAX_VALUE),a=g(-Number.MAX_VALUE);for(let u of this.pts)r.x=Math.min(r.x,u.x),a.x=Math.max(a.x,u.x),r.y=Math.min(r.y,u.y),a.y=Math.max(a.y,u.y);return J.fromPoints(r,a)}};o(se,"Polygon");var Tt=class{constructor(r,a){y(this,"x");y(this,"y");this.x=r,this.y=a}static fromVec2(r){return new Tt(r.x,r.y)}toVec2(){return new L(this.x,this.y)}transform(r){return Tt.fromVec2(r.multVec2(this.toVec2()))}bbox(){return new J(this.toVec2(),0,0)}};o(Tt,"Point");function kn(r,a){let u=Number.MAX_VALUE,l=g(0);for(let w of[r,a])for(let p=0;p<w.pts.length;p++){let S=w.pts[p],R=w.pts[(p+1)%w.pts.length].sub(S).normal().unit(),B=Number.MAX_VALUE,F=-Number.MAX_VALUE;for(let G=0;G<r.pts.length;G++){let C=r.pts[G].dot(R);B=Math.min(B,C),F=Math.max(F,C)}let D=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let G=0;G<a.pts.length;G++){let C=a.pts[G].dot(R);D=Math.min(D,C),x=Math.max(x,C)}let m=Math.min(F,x)-Math.max(B,D);if(m<0)return null;if(m<Math.abs(u)){let G=x-B,C=D-F;u=Math.abs(G)<Math.abs(C)?G:C,l=R.scale(u)}}return l}o(kn,"sat");var Ot=class extends Map{constructor(...a){super(...a);y(this,"lastID");this.lastID=0}push(a){let u=this.lastID;return this.set(u,a),this.lastID++,u}pushd(a){let u=this.push(a);return()=>this.delete(u)}};o(Ot,"IDList");var At=class{constructor(){y(this,"handlers",new Ot)}add(r){return this.handlers.pushd(r)}addOnce(r){let a=this.add((...u)=>{r(...u),a()});return a}trigger(...r){this.handlers.forEach(a=>a(...r))}numListeners(){return this.handlers.size}};o(At,"Event");var Yt=class{constructor(){y(this,"handlers",new Map)}on(r,a){return this.handlers.get(r)||this.handlers.set(r,new At),this.handlers.get(r).add(a)}onOnce(r,a){let u=this.on(r,(...l)=>{a(...l),u()});return u}trigger(r,...a){this.handlers.get(r)&&this.handlers.get(r).trigger(...a)}remove(r){this.handlers.delete(r)}clear(){this.handlers=new Map}numListeners(r){var a,u;return(u=(a=this.handlers.get(r))==null?void 0:a.numListeners())!=null?u:0}};o(Yt,"EventHandler");function Mr(r,a){let u=typeof r,l=typeof a;if(u!==l)return!1;if(u==="object"&&l==="object"){let w=Object.keys(r),p=Object.keys(a);if(w.length!==p.length)return!1;for(let S of w){let R=r[S],B=a[S];if(!(typeof R=="function"&&typeof B=="function")&&!Mr(R,B))return!1}return!0}return r===a}o(Mr,"deepEq");function Ln(r){let a=window.atob(r),u=a.length,l=new Uint8Array(u);for(let w=0;w<u;w++)l[w]=a.charCodeAt(w);return l.buffer}o(Ln,"base64ToArrayBuffer");function Nn(r){return Ln(r.split(",")[1])}o(Nn,"dataURLToArrayBuffer");function oe(r,a){let u=document.createElement("a");u.href=a,u.download=r,u.click()}o(oe,"download");function Pr(r,a){oe(r,"data:text/plain;charset=utf-8,"+a)}o(Pr,"downloadText");function Gn(r,a){Pr(r,JSON.stringify(a))}o(Gn,"downloadJSON");function Sr(r,a){let u=URL.createObjectURL(a);oe(r,u),URL.revokeObjectURL(u)}o(Sr,"downloadBlob");function Rr(r){return r.match(/^data:\w+\/\w+;base64,.+/)}o(Rr,"isDataURL");var ds=(()=>{let r=0;return()=>r++})(),Qn=class{constructor(){y(this,"dts",[]);y(this,"timer",0);y(this,"fps",0)}tick(r){this.dts.push(r),this.timer+=r,this.timer>=1&&(this.timer=0,this.fps=Math.round(1/(this.dts.reduce((a,u)=>a+u)/this.dts.length)),this.dts=[])}};o(Qn,"FPSCounter");var re=class{constructor(r,a){y(this,"time");y(this,"action");y(this,"finished",!1);y(this,"paused",!1);this.time=r,this.action=a}tick(r){return this.finished||this.paused?!1:(this.time-=r,this.time<=0?(this.action(),this.finished=!0,this.time=0,!0):!1)}reset(r){this.time=r,this.finished=!1}};o(re,"Timer");var cs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAACAAQMAAADOEv75AAAAAXNSR0IArs4c6QAAAAZQTFRFAAAA////pdmf3QAAAAF0Uk5TAEDm2GYAAASQSURBVDjLVZVNTBtHFMffrk0YHLc21JVQuwrrdQOOFdVwa0NktlYl3FRVCRLnUvWSICJhuKStIoa1CYs5uAdOyELWlqTWumoFB4RItXJIJCMqxe2x4mIKjRGH2imHGkzsvlljKHPY3Z//M+9rnp7hBBrrKYXXWZd7w4THBlR1I5y1dzuM0iMKtaJx/PNiaFNTH6Jy3agUEfTfo6iMJMYUezfR0tMGGiDuLIDD2H6Dwrlpu/n8urDIXg4VaAd90XtPpCbk7y+ubt8bU0g4l4Cj1yurN3fKkfZYlwC145WH2w88RSP2gwBHZWO19yv3M1QCkJ/8pVariXhmIwDU2TDNBwCi82KnvSeGtnkG33xilfsJgBXBSIaI/LlqAnWNRUHuD1jyKNLANRuVb6HiRCuuVy0gy6SbAXVJnbSHgpMXz7IB9hmeCVwuBMIZIFYBVFVpI1JMxG0SqDTqyfExiXh2eEhN2UPe6LgIMkRBVXjVG53Ng8gRUKPSsVdVpfa3/gSYKCZasiScIcRKztywWGAsLhwWE3O7muJNwGxIixFJpVpkVIN1bzJGRJUuKT8i+MW53Ptluqb4NIjsJ9k2dUm5poHiNc+oGoNxv3C4L8wV0HUCLqxXOeHYq8f8axEFIObVJAQxKU8zSCIMukVZpfCPX5Cu+txBkV2e4lUQBqKik0FIkySfqpowlUq4N1xqfO0yDVz0002AWCilyTwrJIIVKIisoq2/CndzC8uRx55PBYDr2sJ7nZt0TcLkuP3k3B6mvSSlNOBHtQXrFawBAy4t3H3Oz+1r7zTyEaD5gj/BQ93sLZsVFadbYTl9xcz0OzHWBlujyaCZHMg2zFQIXvVJklOkdti6wyPc3kNwwXLq5oeYjz/hoW1AzVbgMvhwQ8vQCDYa+4WWAGz6pTpMlSH4aKSlDpETpjiVvnzVEvm3imdkMUhExSrPVFGhsoRAxHgNz8i0rQGoAN8ADnwAJjhqwCv6JThTmnwOMK3VlY547qRqoWh6qMnXlzH7qbkKuqJP5k3AcFCplUzgyqDTBmAKb3+ROS+eLfm/Sp4qjsy5YqllefxwOQ46cBDUMiIMAwFfB+0zoWQq8dopMKUO6HRoADqmSrsYHosgaUKWsAhOlU2Vy5QaSk7dzQ+DfHsA3uze3aKWYYCkmGKwSVkEp0qOsls5VTLAyXUFr4MNB8lUcNA5jMoBZcq7EbqT02JdhCmpj+lhwTXom2cR/Kaplb+EiQJhEXyJHb+vl3GmoLLiveHMGWVFYgrrt8ZKEb5eE7w5bsBmAci4BvHejiAV7BK4lzd0hLGpAbnLsBTXY0zZ4nFUnkJlrwniRmsuwc5UDninEvhghkgI4edNTl64r2CfcWcTSOAdT9FZO5fxi83COPkIRl78NJGH8gxh8OT7dj3Zi9NRR6i8tFd2YKyujOSMcL//j1vzEgK6h0tUbZIGGTQL4HgCTTDITGPBzDtmTnsiQrogcM/sDL7NGse6PrG3GGQpFH1p/GtITa4jlP8OhD/T0vsPWKaVoqHatKPQJNsWzvrQ+mxo8jyF7TuTWKr/ABVF/mebwsnnAAAAAElFTkSuQmCC",As="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAAA8AgMAAADTWFpWAAAAAXNSR0IArs4c6QAAAAlQTFRFAAAAAAAA////g93P0gAAAAF0Uk5TAEDm2GYAAANeSURBVDjLjVVLruQoEMQLfAMsuU7DEVgklux1YulxGi84AgftiAS/eeqZUTcl47IJ8hMZpJ1zPgYJyUcnIfrkU4hZ3Dv4b4277s8mWa+0PtvzSbcCbmPRCTjb1Usrj3/2FJ6rrS+gTUDtt+SnpDXtbnlqP2CajvxjgCCw0LZ0io8EXK1253htyQB8OHSPNzwScOshPtHCTlcM6Gy1nVLgkTFkWeP6cOV008L+HKnoBQvMgkv0vsbipgXyIBIYFniwbQb7h5B/jZcJ7A0xMCDJwjue08thwKq72icyrQVcXGDgQsIvhztWXNEtFs3qW5GCQPlDiNG3LBueneoaubxJRaoZy3yzxi3VDtAA+La2U7m4wMGwsKOmCzYaYEtcFOz1D9joEADfCTYmxHAIOESI9L7Ca8CWD6zWvlElzICxQw2NZUZWzcctLpplRyyOuTN7ZwzAuPGAIhkP33T9PsKPv9iVsStPS4LZC4bjZEwiY3ivMxZFuGtHQo5BG5NnG/yBSSFNEAvpcl/9C3d3W3okAUQnQhC5loYV/aIhAmojo/Wpzw03axStiS5u8ySk6NsCyYpqFjB3AmYFGQN3MYb5BABiuB4Yn1ngybIYs44sLPPJg4ynycbk4Y9j7GZFON45Q885WiWGf9YU8Vli9F9xImq0g/fmcMgAMA/IB2fqiGczgFpSlj0AJN6DBWqhqLkYaRJwtltxxlE+xbkGozxYg6hs/O0PLQASFZ1hNhGw19QIxglJ9/gnJS7tiNZEwB6iGGpcERZVzixw0qxvQHrBGKMaeQm6DHlwvFyWPzPp02iGnLzwxo5JHieArUZHtG7rvFFR6uo3AHUouIIGdLmAE45+C3Ue0DprhHw/7QZRl7Iel97oF2svEN6XvXcL9lK9VA/OKJS8Ra8V1N/2Hk4u0ySP7+6GJqlqAlgnkt2nBdkBpiaFMLmtjLSgM4Znd8HUwJ3eZutXwTTJb0Zwn0Y9XZiX/9bkePEXUrUzH/+vI2B8oIYazRL8Mwb0qZ+q3qEnaJKfE2TALPqr6mJ5nKjImm5aAAfkARZe0ULVrdgHwaIYB/Vqu3tFS+kNCxYOLajLuoPsIdqrnzMGAzAGVL9t3T5rjY209pGFAVB/hX6Sl1eTn5blBw8yFfc7m+/4BR+d4KDrSif0AAAAAElFTkSuQmCC",fs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAA2CAMAAABAzG8wAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEyUExURQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcPCw4ICA4dFw4eFg4eFxAQEBUsIhUtIhwPDxwQEBw8LR07LR08LSAgICNKOCNLOCRKOCRLOCoXFypZQypaQytZQytaQzAwMDFoTjFoTzFpTzgfHzh3WTh3Wjh4Wjl3WTl3Wjl4Wj+GZUBAQECGZECGZUCHZUYnJ0aVcEeVcE2ke06ke06kfFBQUFQuLlSzhlUuLlWzhlvCkVzCkVzCkmBgYGM2NmPRnWrgqHA+PnBwcHHvs35FRYCAgIxNTY1NTZCQkJtUVJtVVZ+fn6CgoKlcXKldXbdkZL+/v8Vra8VsbNDQ0NNzc9/f3+F7e////ysmAfQAAAAVdFJOUwAQIDBAUGBvcH+AkJ+gr7C/z9Df74JQjt0AAAO5SURBVEjHnVfrQtowFKaADC1qu9I6YSBecIKoOHAD2bhssMpc6zqn010c0/H+r7CcJG2TFAru/LCYnu/kO9ekkUiIxBJyStXSOhJNVeRkPPIIiS8qGMlJWklE50PLQbArKzN5SIuaHiraQjjc3/zZ7lHHtGwHiTXs1XYz7ovUdEc8uLHfsRxRhq1MOIn4U4reMZ0pYpaIyuIk/BMKP7GdELEyUyxIK/PAQU4mWogS+ocz4RALTCLJ749zZ5ghMLteMHQ9VzapG2kuF5h/Dgfe7lbQe6NQ5dJgFbz0rlvOEJnSFTZ9GI/p1w1Ps+ybeGOwtVR3Tnknoh5+mNF5TSJVoRrLzgtwQnINaIQY2kisW2KhzKwcUHIGQyEBSx2k+JpVbNK96P7ZLFk/v9uGh/mKiQIQKAl4/WB8SzTJ8vYDNZAdP8DjnQ1/o34EkQNd/P7WtTAe32EDFsGPvfVror/l+QAEXiICEL/sH19xfA6hcdrwT/Nh7DLAVBBh8CHlRgAiiHfSL8dN14VLEhobZ3D7+j1Zb4JjBiWssgQwJ6RJwqx//4yLxm8fVk4dsqGG8As0AkgOWR0cQQO/sLYEPN7PgV/IwDJNAUhH2MvoTXxB8NSARFLlVnyJVVwf+q1QMgJWiYEEdTSoKUwGu7P7HOZky12lMVhFjyO+b3tHm5ub+61Zk8EkpZhmPXiUtHAdxIDrf+GdIoImcAh2/guPeyEWkdHfWrimdWa2G7VKpVDkRlSbxFCBxgpiLLPdrlUrhVyGnUQ5VgeKS45EVPT46K8OKkUew9eVkAPoZkiCny8r/FgtCQRWUSHDOu9XQDY2jvv9Pb9jfM14wECXxVx8ufr26/f9X5BRnieAGxQPA94AdoFiOPngTl0qZW+eaTwziN+PIP7KnQFU8JRcwuNM5dMIzdgP4EdrfMcNdDpL6DRoCMkZifi8N1qIowZzMibR7wKTHQjOMY+/3+MdIBNugT3UmMbt6aITBH/on+2GHwAQqOWqUCD62xHPnylicvj5eHKsDZkmwwTzX+n2F2v+uQ1vqyKeHqx24A6U79/8vPm0pnP4YS6Ij8Q5lUnHQMl2ryjkwpsQbkeyLpQZvUW5LXjK3zG0WOB6pmK9BjeaM8Jotut0RZYmXG9Vcgq0bWE0o6suWRpU6YzQJl+1JZluV+4GZ7k9qLp00kvStDtywruh54q1rnvDPus2Kjn/a2E6HCpyOXwYzYBjE0vTvxPSSnzOLxV10geGHJfm/1aS4klZUQgXTVtJJWeA/wFPmR833RRQSAAAAABJRU5ErkJggg==",ps="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAOVJREFUWEftluEOwjAIhNcnNz55Tac1swHuTpo1mu3nwnofB6OUbfFTFutvF8DPOFDJXpETYj6otd4p/VJuYxw8HwXQ4hbhAcjViQBS4kegF4ipdQpAg/EgPIBp2SMnpgO0TL2mtVywANzso8Op38QohQTAikRxowv/DzCW7XQHpgF804DWNykHFAhGfB9QRseGQwhB9PlvzYL0HOiwxq33zkMZQp4D7f3UUbz0MorEIwe6pSknkDgDsJfjWRNuKxr6BC080lpOucFsQR9XtHjBMMspzDoDIPLicIkWH6dHXADLHXgASmZzISXNKJcAAAAASUVORK5CYIIA",gs=as("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L5QNSqT5iiySS9Ja2SV//5ME0ak//+4KgAAABgQBAADAMDgYCAEgCteQ0fZH6+ICXA357+MPfhR/+ywRf/U///LVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+5JknQAFoWhGLm5gBClBmT3GiAAAAAGkHAAAIAAANIOAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV"),ms="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJ0AAAA4CAMAAADQKQq5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADMUExURQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAPBxAPCCAeDiAeDyAfDjAtFTAtFjAtFzAuFkA8HUA9HVBLJFBLJVBMJFBMJV9aLF9bLGBaLGBbLG9qM3BpM3BpNHBqM3BqNH95O4B4O4B5O4+IQo+IQ5CHQpCIQp+XSZ+XSqCWSqCXSq+mUbCmUb+1WL+1Wc/EYNDEYN/TZ+/ib//xdm9pB9AAAAAXdFJOUwAQIDBAUF9gb3B/gI+Qn6CvsL/P0N/vIiFUiwAAByxJREFUaN7tmll72jgUhvFCKRAohRrb0NKapnTwkAWmoQzEIbL+/3+qdRZJNnm6pOM0F6ObgrGl12f5dI7SRuP/UcdwnxXNy2HH/joMg9bzgWuFYWjhnRVfw8B/LnQ9hfOCv3VCHP2qf732YBy8eHK6oYIZe+TlUA+LT5HBtfGT041g3QBYfPVxkiJegDnCZDCenI7WHTkFCXDcS7GASwrYtdDoEg3Hbba6deePpz3ZcAP17z9Syhttu4B/jhYx0zXbvcGIqEf16k+zWGL+WS3UAZLrAi6DGHN1kkSL7VHKKdENStYMasXrFitc5jNe7O8CTigrhSpPXPVhUZCpkRSfC6VxwvIYt2uke10ssJVigkvNFZwyUthmv06ELNH5jPV2np7Dh069gpJJeQR7TXIpc4DravHbE5xUqdxCYy++HpH5GvAGTl10KrqV63ZspkTDgV9TWaFDY/P4EtcZfBBFaIbog4K7AGM0Tvyq6UZobB4YEzVtfSqK3pm15BrWck79KuUGbAqvowJgtUJwgRlVC167mPiTIbgxftJ+FcrXU0F0/DoJXINxpWOhjhpgo+EOVhBpv0KWFJxbkGx6HaGuzXLj825dKXurY0gLneXXG9aaHdC9wqTYwMXE9jmEcct7SPFbj8yaUoxvtNBZfo2R7h3R0QNo0HBZonM6hQIE/WaZxVcWGLYeozoU45Zj22W/LtV2oAIP9rchPZCxJK+tfOnoimHU00ninPGe0i8nzstg+COLqhogMkmRlPbXPclgGBg69cCEEiHkV1N0vU65mqEN5KV9NbBqRhfe9SdqAEu8YnzG6PB7XaNAIgQtfCA9oePbIhsPnFqMD/r3EYegit/QqRizEp9QA1hyR741OjzV8yId5fgR9+W3b3fSpouuC6dfzhmviR8mmRS7iSm6HV2adSuGUvHpVmsAULqPN+ofta+Pz4wO73jOd0jHOZ4LocM1Xxk2vLCLTUkWXePFY8qAPeq1Sp2AqyvJs2oNgCWdwswpRc3+KrLDdpNeFpYMKUGOJhK+bpazuMIGKDxNuBCWZzAgRrpfMDuMgWNJs2oASM1ITX9H3rAm5aEjkMfOivhFXrqX8dLyFOILhhuXYcNS75VifLaqNYAw6oXpuD+Fk7GpAU2K8yDRzLfJZG3hnbzkFCymcmJi2alDla+YW3S6BiAr3Klp7VfORWXiUhYZXVEqA2h6Gtj4cJ6byST5uNoeMkGB3QZNyBKdFwA3swqhcg1AC0/pI/v138IA8SxZbo7WTbfyPo7BPljwjweEseRgu+RYAdNl5h0OCN1vw/sogRg7ulEVVTquAfQEGyyh9va+q81BjjyCCE7VPflny7EmClUAQ/2fyrIafsK4DgJYAzKwSRkRCVmlY31Q7/laoUaZ7ddzM+/G0LERoYC6Mo7Fq8MxvstaR50VnYVvcn4DgdxDSteDPKGjLR1eouXwpsN+tVPyUsPOjUTf6c4ipbu7HvgjwXtSnUwtv92jdH9vkhlCHPeTa3lKB+tuNkvsrdu0aHKAMAPfFK/m92iylKedWgZFvFtctc9BlMsZ/56x6tK+R9bWZg24Ua0UY+YcgCYemq+zZKVLgiblDtJtDd2RV48odF2edA/RDwK6ZVkLkGlnydKBV5MP0PmVExIvrI4u3zbX4Z1RJEWXmbZwSibp8MGLQNotS4jS1jE+LGw9javSb9E5prwZmLM8u+TRxc5U0+WqBohSUl9szfckb0VvxscdO66dp9gMOG9Ys2OWR54yEvIhuobbpcGVa7PtFfE7HJWOnBRdVIjeeVhp4Lg1t9Ij5BDf8A9g6MDra3/GdJQEz1vpekL3nbK02R0M/PIhGkuWNS6MPOjTDsy/K248xMwEc87aqq11bdL1F+hOzgt4bO25tOaA9uVXBo5VztJECq/zcm0ARx4imVEgbqnC+pWDb6u82WSmGIGgC7qmebwrzPeX7XJLdAhOWCXDenkw5YTQ79v/5QONIhy7fHAXJ6ttduTdwcVcwu5M7HC9bGptalJ+MYm5NDlxwUzrcrXbf/yZiy2JrDlD3Z1RrGM4BmPdyh/n83upTbc3hyJqD7q3Sp/H050IDs/kjEp4ZLjA65IUVXIcTXfPtkVRos79N+gafpHJowfOZXEjVyYRQlAe9xw09t1JjqdGKJVtz+2S+3foSG2UJI5LfQHuELGF7XNTNd1r+TiudR7nOjAv+BHx39BRFBaG9EsnbdboOfbV6TLLs1USW4oJtWmPpeqNPs65/Ykm/JFHbWXDNcp1RakDWWPMdjk+eqykWT10tFIQBMOuafHd0Sld0WUkdIZJG30T2ttPddI1HPehYya3Zf6SFYyrCdUjUfI4u2uj+06q90bhsNd0GrYlPS4w3rCUTiaTcpP7xMMzWyL9DaY1wnMya6/8Y3RgLtfzfb96RPrKonv97P4zgschOf7xoeOfMKnvuy5xfQNBzpIQ0qYPEAAAAABJRU5ErkJggg==",Vs="data:image/png;base64,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",fn={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down"," ":"space"},pn=["left","middle","right","back","forward"],ws=["space","left","right","up","down","tab","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","s"],gn=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",Es=" \u263A\u263B\u2665\u2666\u2663\u2660\u2022\u25D8\u25CB\u25D9\u2642\u2640\u266A\u266B\u263C\u25BA\u25C4\u2195\u203C\xB6\xA7\u25AC\u21A8\u2191\u2193\u2192\u2190\u221F\u2194\u25B2\u25BC !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u2302\xC7\xFC\xE9\xE2\xE4\xE0\xE5\xE7\xEA\xEB\xE8\xEF\xEE\xEC\xC4\xC5\xC9\xE6\xC6\xF4\xF6\xF2\xFB\xF9\xFF\xD6\xDC\xA2\xA3\xA5\u20A7\u0192\xE1\xED\xF3\xFA\xF1\xD1\xAA\xBA\xBF\u2310\xAC\xBD\xBC\xA1\xAB\xBB\u2591\u2592\u2593\u2502\u2524\u2561\u2562\u2556\u2555\u2563\u2551\u2557\u255D\u255C\u255B\u2510\u2514\u2534\u252C\u251C\u2500\u253C\u255E\u255F\u255A\u2554\u2569\u2566\u2560\u2550\u256C\u2567\u2568\u2564\u2565\u2559\u2558\u2552\u2553\u256B\u256A\u2518\u250C\u2588\u2584\u258C\u2590\u2580\u03B1\xDF\u0393\u03C0\u03A3\u03C3\xB5\u03C4\u03A6\u0398\u03A9\u03B4\u221E\u03C6\u03B5\u2229\u2261\xB1\u2265\u2264\u2320\u2321\xF7\u2248\xB0\u2219\xB7\u221A\u207F\xB2\u25A0",mn=0,Vn=3,ys=0,xs=3,vs=-1200,bs=1200,xe="topleft",wn=64,Ss="sink",ve="sink",Rs=16,En=64,be=1024,yn=.05,Bs=1,Yn=[{name:"a_pos",size:3},{name:"a_uv",size:2},{name:"a_color",size:4}],Re=Yn.reduce((r,a)=>r+a.size,0),Kn=2048,xn=Kn*4*Re,vn=Kn*6,Fs=`
attribute vec3 a_pos;
attribute vec2 a_uv;
attribute vec4 a_color;

varying vec3 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

vec4 def_vert() {
	return vec4(a_pos, 1.0);
}

{{user}}

void main() {
	vec4 pos = vert(a_pos, a_uv, a_color);
	v_pos = a_pos;
	v_uv = a_uv;
	v_color = a_color;
	gl_Position = pos;
}
`,Cs=`
precision mediump float;

varying vec3 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

uniform sampler2D u_tex;

vec4 def_frag() {
	return v_color * texture2D(u_tex, v_uv);
}

{{user}}

void main() {
	gl_FragColor = frag(v_pos, v_uv, v_color, u_tex);
	if (gl_FragColor.a == 0.0) {
		discard;
	}
}
`,yr=`
vec4 vert(vec3 pos, vec2 uv, vec4 color) {
	return def_vert();
}
`,xr=`
vec4 frag(vec3 pos, vec2 uv, vec4 color, sampler2D tex) {
	return def_frag();
}
`,Ts=new Set(["id","require"]),Is=new Set(["add","update","draw","destroy","inspect","drawInspect"]);function Br(r){return r==="pressed"||r==="rpressed"?"down":r==="released"?"up":r}o(Br,"processButtonState");function qn(r){r.requestFullscreen?r.requestFullscreen():r.webkitRequestFullscreen&&r.webkitRequestFullscreen()}o(qn,"enterFullscreen");function On(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullScreen&&document.webkitExitFullScreen()}o(On,"exitFullscreen");function Jn(){return document.fullscreenElement||document.webkitFullscreenElement}o(Jn,"getFullscreenElement");function Kt(r){switch(r){case"topleft":return g(-1,-1);case"top":return g(0,-1);case"topright":return g(1,-1);case"left":return g(-1,0);case"center":return g(0,0);case"right":return g(1,0);case"botleft":return g(-1,1);case"bot":return g(0,1);case"botright":return g(1,1);default:return r}}o(Kt,"originPt");function zn(r){switch(r){case"left":return 0;case"center":return .5;case"right":return 1;default:return 0}}o(zn,"alignPt");function Be(){return new AudioBuffer({length:1,numberOfChannels:1,sampleRate:44100})}o(Be,"createEmptyAudioBuffer");var Us=o((r={})=>{let a=[],u=(()=>{var V,E,v;let t=(V=r.root)!=null?V:document.body;t===document.body&&(document.body.style.width="100%",document.body.style.height="100%",document.body.style.margin="0px",document.documentElement.style.width="100%",document.documentElement.style.height="100%");let e=(E=r.canvas)!=null?E:(()=>{let b=document.createElement("canvas");return t.appendChild(b),b})(),i=(v=r.scale)!=null?v:1,s=!(r.width&&r.height&&!r.stretch&&!r.letterbox),c=e.parentElement.offsetWidth,n=e.parentElement.offsetHeight;s?(e.width=c,e.height=n):(e.width=r.width*i,e.height=r.height*i);let d=e.width,h=e.height,A=r.pixelDensity||window.devicePixelRatio;e.width*=A,e.height*=A;let f=[`width: ${d}px`,`height: ${h}px`,"outline: none","cursor: default"];return r.crisp&&(f.push("image-rendering: pixelated"),f.push("image-rendering: crisp-edges")),e.style=f.join(";"),e.setAttribute("tabindex","0"),{canvas:e,canvas2:e.cloneNode(),pixelDensity:A,stretchToParent:s,lastParentWidth:c,lastParentHeight:n,keyStates:{},mouseStates:{},charInputted:[],numKeyDown:0,isMouseMoved:!1,isKeyPressed:!1,isKeyPressedRepeat:!1,isKeyReleased:!1,mouseStarted:!1,mousePos:g(0,0),mouseDeltaPos:g(0,0),time:0,realTime:0,skipTime:!1,dt:0,numFrames:0,isTouch:"ontouchstart"in window||navigator.maxTouchPoints>0,loopID:null,stopped:!1,paused:!1,fpsCounter:new Qn}})(),l=u.canvas.getContext("webgl",{antialias:!0,depth:!0,stencil:!0,alpha:!0,preserveDrawingBuffer:!0});class w{constructor(e,i,s={}){y(this,"glTex");y(this,"width");y(this,"height");this.glTex=l.createTexture(),a.push(()=>this.free()),this.bind(),e&&i&&l.texImage2D(l.TEXTURE_2D,0,l.RGBA,e,i,0,l.RGBA,l.UNSIGNED_BYTE,null),this.width=e,this.height=i;let c=(()=>{var d;switch((d=s.filter)!=null?d:r.texFilter){case"linear":return l.LINEAR;case"nearest":return l.NEAREST;default:return l.NEAREST}})(),n=(()=>{switch(s.wrap){case"repeat":return l.REPEAT;case"clampToEdge":return l.CLAMP_TO_EDGE;default:return l.CLAMP_TO_EDGE}})();l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,c),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,c),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,n),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,n),this.unbind()}static fromImage(e,i={}){let s=new w(0,0,i);return s.bind(),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,e),s.width=e.width,s.height=e.height,s.unbind(),s}update(e,i,s){this.bind(),l.texSubImage2D(l.TEXTURE_2D,0,e,i,l.RGBA,l.UNSIGNED_BYTE,s),this.unbind()}bind(){l.bindTexture(l.TEXTURE_2D,this.glTex)}unbind(){l.bindTexture(l.TEXTURE_2D,null)}free(){l.deleteTexture(this.glTex)}}o(w,"Texture");let p=(()=>{var n;let t=ae(yr,xr),e=w.fromImage(new ImageData(new Uint8ClampedArray([255,255,255,255]),1,1));if(r.background){let d=I.fromArray(r.background);l.clearColor(d.r/255,d.g/255,d.b/255,(n=r.background[3])!=null?n:1)}l.enable(l.BLEND),l.enable(l.SCISSOR_TEST),l.blendFuncSeparate(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA);let i=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,i),l.bufferData(l.ARRAY_BUFFER,xn*4,l.DYNAMIC_DRAW),Yn.reduce((d,h,A)=>(l.vertexAttribPointer(A,h.size,l.FLOAT,!1,Re*4,d),l.enableVertexAttribArray(A),d+h.size*4),0),l.bindBuffer(l.ARRAY_BUFFER,null);let s=l.createBuffer();l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,s),l.bufferData(l.ELEMENT_ARRAY_BUFFER,vn*4,l.DYNAMIC_DRAW),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,null);let c=w.fromImage(new ImageData(new Uint8ClampedArray([128,128,128,255,190,190,190,255,190,190,190,255,128,128,128,255]),2,2),{wrap:"repeat",filter:"nearest"});return{drawCalls:0,lastDrawCalls:0,defShader:t,curShader:t,defTex:e,curTex:e,curUniform:{},vbuf:i,ibuf:s,vqueue:[],iqueue:[],transform:new P,transformStack:[],bgTex:c,width:r.width,height:r.height,viewport:{x:0,y:0,width:l.drawingBufferWidth,height:l.drawingBufferHeight}}})();class S{constructor(e,i,s={}){y(this,"tex");y(this,"frames",[new O(0,0,1,1)]);y(this,"anims",{});this.tex=e,i&&(this.frames=i),this.anims=s}static from(e,i={}){return typeof e=="string"?S.fromURL(e,i):Promise.resolve(S.fromImage(e,i))}static fromImage(e,i={}){var s;return new S(w.fromImage(e,i),Te(i.sliceX||1,i.sliceY||1),(s=i.anims)!=null?s:{})}static fromURL(e,i={}){return lt(e).then(s=>S.fromImage(s,i))}}o(S,"SpriteData");class R{constructor(e){y(this,"buf");this.buf=e}static fromArrayBuffer(e){return new Promise((i,s)=>B.ctx.decodeAudioData(e,i,s)).then(i=>new R(i))}static fromURL(e){return Rr(e)?R.fromArrayBuffer(Nn(e)):xt(e).then(i=>R.fromArrayBuffer(i))}}o(R,"SoundData");let B=(()=>{let t=new(window.AudioContext||window.webkitAudioContext),e=t.createGain();e.connect(t.destination);let i=new R(Be());return t.decodeAudioData(gs.buffer.slice(0),s=>{i.buf=s},()=>{throw new Error("Failed to load burp.")}),{ctx:t,masterNode:e,burpSnd:i}})();class F{constructor(e){y(this,"done",!1);y(this,"data",null);y(this,"error",null);y(this,"onLoadEvents",new At);y(this,"onErrorEvents",new At);y(this,"onFinishEvents",new At);e.then(i=>{this.data=i,this.onLoadEvents.trigger(i)}).catch(i=>{if(this.error=i,this.onErrorEvents.numListeners()>0)this.onErrorEvents.trigger(i);else throw i}).finally(()=>{this.onFinishEvents.trigger(),this.done=!0})}static loaded(e){let i=new F(Promise.resolve(e));return i.data=e,i.done=!0,i}onLoad(e){return this.onLoadEvents.add(e),this}onError(e){return this.onErrorEvents.add(e),this}onFinish(e){return this.onFinishEvents.add(e),this}then(e){return this.onLoad(e)}catch(e){return this.onError(e)}finally(e){return this.onFinish(e)}}o(F,"Asset");class D{constructor(){y(this,"assets",new Map);y(this,"lastUID",0)}add(e,i){let s=e!=null?e:this.lastUID+++"",c=new F(i);return this.assets.set(s,c),c}addLoaded(e,i){let s=e!=null?e:this.lastUID+++"",c=F.loaded(i);this.assets.set(s,c)}get(e){return this.assets.get(e)}progress(){if(this.assets.size===0)return 1;let e=0;return this.assets.forEach(i=>{i.done&&e++}),e/this.assets.size}}o(D,"AssetBucket");let x={urlPrefix:"",sprites:new D,fonts:new D,bitmapFonts:new D,sounds:new D,shaders:new D,custom:new D,loaded:!1},m={ev:new Yt,objEvents:new Yt,root:pe([]),timers:new Ot,gravity:0,scenes:{},logs:[],cam:{pos:null,scale:g(1),angle:0,shake:0,transform:new P}};function G(t){return x.custom.add(null,t)}o(G,"load");function C(){let t=[x.sprites,x.sounds,x.shaders,x.fonts,x.bitmapFonts,x.custom];return t.reduce((e,i)=>e+i.progress(),0)/t.length}o(C,"loadProgress");function $(t){return t!==void 0&&(x.urlPrefix=t),x.urlPrefix}o($,"loadRoot");function j(t){let e=x.urlPrefix+t;return fetch(e).then(i=>{if(!i.ok)throw new Error(`Failed to fetch ${e}`);return i})}o(j,"fetchURL");function tt(t){return j(t).then(e=>e.json())}o(tt,"fetchJSON");function yt(t){return j(t).then(e=>e.text())}o(yt,"fetchText");function xt(t){return j(t).then(e=>e.arrayBuffer())}o(xt,"fetchArrayBuffer");function lt(t){let e=new Image;return e.src=Rr(t)?t:x.urlPrefix+t,e.crossOrigin="anonymous",new Promise((i,s)=>{e.onload=()=>i(e),e.onerror=()=>s(new Error(`Failed to load image from "${t}"`))})}o(lt,"loadImg");function It(t,e){let i=new FontFace(t,typeof e=="string"?`url(${e})`:e);return document.fonts.add(i),x.fonts.add(t,i.load().catch(()=>{throw new Error(`Failed to load font from "${e}"`)}))}o(It,"loadFont");function ft(t,e,i,s,c={}){return x.bitmapFonts.add(t,lt(e).then(n=>{var d;return Jr(w.fromImage(n,c),i,s,(d=c.chars)!=null?d:gn)}))}o(ft,"loadBitmapFont");function Te(t=1,e=1,i=0,s=0,c=1,n=1){let d=[],h=c/t,A=n/e;for(let f=0;f<e;f++)for(let V=0;V<t;V++)d.push(new O(i+V*h,s+f*A,h,A));return d}o(Te,"slice");function Ie(t,e){return G(typeof e=="string"?new Promise((i,s)=>{tt(e).then(c=>{Ie(t,c).onLoad(i).onError(s)})}):S.from(t).then(i=>{let s={};for(let c in e){let n=i.tex.width,d=i.tex.height,h=e[c],A=new S(i.tex,Te(h.sliceX,h.sliceY,h.x/n,h.y/d,h.width/n,h.height/d),h.anims);x.sprites.addLoaded(c,A),s[c]=A}return s}))}o(Ie,"loadSpriteAtlas");function pt(t,e,i={sliceX:1,sliceY:1,anims:{}}){return x.sprites.add(t,typeof e=="string"?S.fromURL(e,i):Promise.resolve(S.fromImage(e,i)))}o(pt,"loadSprite");function Dr(t,e){return x.sprites.add(t,new Promise(async i=>{let s=typeof e=="string"?await tt(e):e,c=await Promise.all(s.frames.map(lt)),n=document.createElement("canvas");n.width=s.width,n.height=s.height*s.frames.length;let d=n.getContext("2d");c.forEach((A,f)=>{d.drawImage(A,0,f*s.height)});let h=await pt(null,n,{sliceY:s.frames.length,anims:s.anims});i(h)}))}o(Dr,"loadPedit");function kr(t,e,i){return x.sprites.add(t,new Promise(async s=>{let c=await pt(null,e),n=typeof i=="string"?await tt(i):i,d=n.meta.size;c.frames=n.frames.map(h=>new O(h.frame.x/d.w,h.frame.y/d.h,h.frame.w/d.w,h.frame.h/d.h));for(let h of n.meta.frameTags)h.from===h.to?c.anims[h.name]=h.from:c.anims[h.name]={from:h.from,to:h.to,speed:10,loop:!0,pingpong:h.direction==="pingpong"};s(c)}))}o(kr,"loadAseprite");function Lr(t,e,i,s=!1){return x.shaders.add(t,new Promise((c,n)=>{let d=o(h=>h?yt(h):new Promise(A=>A(null)),"resolveUrl");if(s)Promise.all([d(e),d(i)]).then(([h,A])=>{c(ae(h,A))}).catch(n);else try{c(ae(e,i))}catch(h){n(h)}}))}o(Lr,"loadShader");function Nr(t,e){return x.sounds.add(t,typeof e=="string"?R.fromURL(e):R.fromArrayBuffer(e))}o(Nr,"loadSound");function Gr(t="bean"){return pt(t,fs)}o(Gr,"loadBean");function Qr(t="mark"){return pt(t,ps)}o(Qr,"loadMark");function Ue(t){return x.sprites.get(t)}o(Ue,"getSprite");function Me(t){return x.sounds.get(t)}o(Me,"getSound");function Yr(t){return x.fonts.get(t)}o(Yr,"getFont");function Pe(t){return x.bitmapFonts.get(t)}o(Pe,"getBitmapFont");function De(t){return x.shaders.get(t)}o(De,"getShader");function ke(t){if(typeof t=="string"){let e=Ue(t);if(e)return e;if(C()<1)return null;throw new Error(`Sprite not found: ${t}`)}else{if(t instanceof S)return F.loaded(t);if(t instanceof F)return t;throw new Error(`Invalid sprite: ${t}`)}}o(ke,"resolveSprite");function Kr(t){if(typeof t=="string"){let e=Me(t);if(e)return e.data?e.data:e;if(C()<1)return null;throw new Error(`Sound not found: ${t}`)}else{if(t instanceof R)return t;if(t instanceof F)return t.data?t.data:t;throw new Error(`Invalid sound: ${t}`)}}o(Kr,"resolveSound");function qr(t){if(!t)return p.defShader;if(typeof t=="string"){let e=De(t);if(e)return e.data?e.data:e;if(C()<1)return null;throw new Error(`Shader not found: ${t}`)}else if(t instanceof F)return t.data?t.data:t;return t}o(qr,"resolveShader");function Le(t){var e;if(!t)return Le((e=r.font)!=null?e:Ss);if(typeof t=="string"){let i=Pe(t);if(i)return i.data?i.data:i;if(document.fonts.check(`${En}px ${t}`))return t;if(C()<1)return null;throw new Error(`Font not found: ${t}`)}else if(t instanceof F)return t.data?t.data:t;return t}o(Le,"resolveFont");function Or(t){return t!==void 0&&(B.masterNode.gain.value=ot(t,mn,Vn)),B.masterNode.gain.value}o(Or,"volume");function Ut(t,e={loop:!1,volume:1,speed:1,detune:0,seek:0}){var E;let i=Kr(t);if(i instanceof F){let v=Ut(new R(Be())),b=o(N=>{let z=Ut(N,e);for(let K in z)v[K]=z[K]},"doPlay");return i.onLoad(b),v}else if(i===null){let v=Ut(new R(Be()));return _t(()=>{}),v}let s=B.ctx,c=!1,n=s.createBufferSource();n.buffer=i.buf,n.loop=!!e.loop;let d=s.createGain();n.connect(d),d.connect(B.masterNode);let h=(E=e.seek)!=null?E:0;n.start(0,h);let A=s.currentTime-h,f=null,V={stop(){c||(this.pause(),A=s.currentTime)},play(v){if(!c)return;let b=n;n=s.createBufferSource(),n.buffer=b.buffer,n.loop=b.loop,n.playbackRate.value=b.playbackRate.value,n.detune&&(n.detune.value=b.detune.value),n.connect(d);let N=v!=null?v:this.time();n.start(0,N),A=s.currentTime-N,c=!1,f=null},pause(){c||(n.stop(),c=!0,f=s.currentTime)},isPaused(){return c},isStopped(){return c},speed(v){return v!==void 0&&(n.playbackRate.value=ot(v,ys,xs)),n.playbackRate.value},detune(v){return n.detune?(v!==void 0&&(n.detune.value=ot(v,vs,bs)),n.detune.value):0},volume(v){return v!==void 0&&(d.gain.value=ot(v,mn,Vn)),d.gain.value},loop(){n.loop=!0},unloop(){n.loop=!1},duration(){return i.buf.duration},time(){return c?f-A:s.currentTime-A}};return V.speed(e.speed),V.detune(e.detune),V.volume(e.volume),V}o(Ut,"play");function Ne(t){return Ut(B.burpSnd,t)}o(Ne,"burp");function ae(t=yr,e=xr){let i=Fs.replace("{{user}}",t!=null?t:yr),s=Cs.replace("{{user}}",e!=null?e:xr),c=l.createShader(l.VERTEX_SHADER),n=l.createShader(l.FRAGMENT_SHADER);l.shaderSource(c,i),l.shaderSource(n,s),l.compileShader(c),l.compileShader(n);let d=l.createProgram();if(a.push(()=>l.deleteProgram(d)),l.attachShader(d,c),l.attachShader(d,n),l.bindAttribLocation(d,0,"a_pos"),l.bindAttribLocation(d,1,"a_uv"),l.bindAttribLocation(d,2,"a_color"),l.linkProgram(d),!l.getProgramParameter(d,l.LINK_STATUS)){let h=o(E=>{let v=/^ERROR:\s0:(?<line>\d+):\s(?<msg>.+)/,b=E.match(v);return{line:Number(b.groups.line),msg:b.groups.msg.replace(/\n\0$/,"")}},"formatShaderError"),A=l.getShaderInfoLog(c),f=l.getShaderInfoLog(n),V="";if(A){let E=h(A);V+=`Vertex shader line ${E.line-14}: ${E.msg}`}if(f){let E=h(f);V+=`Fragment shader line ${E.line-14}: ${E.msg}`}throw new Error(V)}return l.deleteShader(c),l.deleteShader(n),{bind(){l.useProgram(d)},unbind(){l.useProgram(null)},free(){l.deleteProgram(d)},send(h){for(let A in h){let f=h[A],V=l.getUniformLocation(d,A);typeof f=="number"?l.uniform1f(V,f):f instanceof P?l.uniformMatrix4fv(V,!1,new Float32Array(f.m)):f instanceof I?l.uniform4f(V,f.r,f.g,f.b,f.a):f instanceof Cr?l.uniform3f(V,f.x,f.y,f.z):f instanceof L&&l.uniform2f(V,f.x,f.y)}}}}o(ae,"makeShader");function Jr(t,e,i,s){let c=t.width/e,n={},d=s.split("").entries();for(let[h,A]of d)n[A]=new O(h%c*e,Math.floor(h/c)*i,e,i);return{tex:t,map:n,size:i}}o(Jr,"makeFont");function ue(t,e,i,s=p.defTex,c=p.defShader,n={}){let d=qr(c);if(!(!d||d instanceof F)){(s!==p.curTex||d!==p.curShader||!Mr(p.curUniform,n)||p.vqueue.length+t.length*Re>xn||p.iqueue.length+e.length>vn)&&ht();for(let h of t){let A=i?p.transform:m.cam.transform.mult(p.transform),f=jr(A.multVec2(h.pos.xy()));p.vqueue.push(f.x,f.y,h.pos.z,h.uv.x,h.uv.y,h.color.r/255,h.color.g/255,h.color.b/255,h.opacity)}for(let h of e)p.iqueue.push(h+p.vqueue.length/Re-t.length);p.curTex=s,p.curShader=d,p.curUniform=n}}o(ue,"drawRaw");function ht(){!p.curTex||!p.curShader||p.vqueue.length===0||p.iqueue.length===0||(l.bindBuffer(l.ARRAY_BUFFER,p.vbuf),l.bufferSubData(l.ARRAY_BUFFER,0,new Float32Array(p.vqueue)),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,p.ibuf),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,new Uint16Array(p.iqueue)),p.curShader.bind(),p.curShader.send(p.curUniform),p.curTex.bind(),l.drawElements(l.TRIANGLES,p.iqueue.length,l.UNSIGNED_SHORT,0),p.curTex.unbind(),p.curShader.unbind(),l.bindBuffer(l.ARRAY_BUFFER,null),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,null),p.vqueue=[],p.iqueue=[],p.drawCalls++)}o(ht,"flush");function zr(){ii(),l.clear(l.COLOR_BUFFER_BIT),r.background||ct(()=>{bt({width:Q(),height:Y(),quad:new O(0,0,Q()/wn,Y()/wn),tex:p.bgTex,fixed:!0})}),p.drawCalls=0,p.transformStack=[],p.transform=new P}o(zr,"frameStart");function Hr(){ht(),p.lastDrawCalls=p.drawCalls}o(Hr,"frameEnd");function jr(t){return g(t.x/Q()*2-1,-t.y/Y()*2+1)}o(jr,"screen2ndc");function Wr(t){p.transform=t.clone()}o(Wr,"pushMatrix");function k(...t){if(t[0]===void 0)return;let e=g(...t);e.x===0&&e.y===0||(p.transform=p.transform.translate(e))}o(k,"pushTranslate");function vt(...t){if(t[0]===void 0)return;let e=g(...t);e.x===1&&e.y===1||(p.transform=p.transform.scale(e))}o(vt,"pushScale");function Xr(t){!t||(p.transform=p.transform.rotateX(t))}o(Xr,"pushRotateX");function Zr(t){!t||(p.transform=p.transform.rotateY(t))}o(Zr,"pushRotateY");function gt(t){!t||(p.transform=p.transform.rotateZ(t))}o(gt,"pushRotateZ");let Hn=gt;function et(){p.transformStack.push(p.transform.clone())}o(et,"pushTransform");function W(){p.transformStack.length>0&&(p.transform=p.transformStack.pop())}o(W,"popTransform");function bt(t){var b;if(t.width===void 0||t.height===void 0)throw new Error('drawUVQuad() requires property "width" and "height".');if(t.width<=0||t.height<=0)return;let e=t.width,i=t.height,s=Kt(t.origin||xe).scale(g(e,i).scale(-.5)),c=t.quad||new O(0,0,1,1),n=t.color||T(255,255,255),d=(b=t.opacity)!=null?b:1,h=t.tex?yn/t.tex.width:0,A=t.tex?yn/t.tex.height:0,f=c.x+h,V=c.y+A,E=c.w-h*2,v=c.h-A*2;et(),k(t.pos),gt(t.angle),vt(t.scale),k(s),ue([{pos:Bt(-e/2,i/2,0),uv:g(t.flipX?f+E:f,t.flipY?V:V+v),color:n,opacity:d},{pos:Bt(-e/2,-i/2,0),uv:g(t.flipX?f+E:f,t.flipY?V+v:V),color:n,opacity:d},{pos:Bt(e/2,-i/2,0),uv:g(t.flipX?f:f+E,t.flipY?V+v:V),color:n,opacity:d},{pos:Bt(e/2,i/2,0),uv:g(t.flipX?f:f+E,t.flipY?V:V+v),color:n,opacity:d}],[0,1,3,1,2,3],t.fixed,t.tex,t.shader,t.uniform),W()}o(bt,"drawUVQuad");function _r(t){var n;if(!t.tex)throw new Error('drawTexture() requires property "tex".');let e=(n=t.quad)!=null?n:new O(0,0,1,1),i=t.tex.width*e.w,s=t.tex.height*e.h,c=g(1);if(t.tiled){let d=Math.ceil((t.width||i)/i),h=Math.ceil((t.height||s)/s),A=Kt(t.origin||xe).add(g(1,1)).scale(.5).scale(d*i,h*s);for(let f=0;f<d;f++)for(let V=0;V<h;V++)bt({...t,pos:(t.pos||g(0)).add(g(i*f,s*V)).sub(A),scale:c.scale(t.scale||g(1)),tex:t.tex,quad:e,width:i,height:s,origin:"topleft"})}else t.width&&t.height?(c.x=t.width/i,c.y=t.height/s):t.width?(c.x=t.width/i,c.y=c.x):t.height&&(c.y=t.height/s,c.x=c.y),bt({...t,scale:c.scale(t.scale||g(1)),tex:t.tex,quad:e,width:i,height:s})}o(_r,"drawTexture");function Ge(t){var s,c;if(!t.sprite)throw new Error('drawSprite() requires property "sprite"');let e=ke(t.sprite);if(!e||!e.data)return;let i=e.data.frames[(s=t.frame)!=null?s:0];if(!i)throw new Error(`Frame not found: ${(c=t.frame)!=null?c:0}`);_r({...t,tex:e.data.tex,quad:i.scale(t.quad||new O(0,0,1,1))})}o(Ge,"drawSprite");function Mt(t,e,i,s,c,n=1){s=Et(s%360),c=Et(c%360),c<=s&&(c+=Math.PI*2);let d=Math.ceil(Math.max(Math.sqrt(e+i)*3*(n||1),16)),h=(c-s)/d,A=[];for(let f=s;f<c;f+=h)A.push(t.add(e*Math.cos(f),i*Math.sin(f)));return A.push(t.add(e*Math.cos(c),i*Math.sin(c))),A}o(Mt,"getArcPts");function rt(t){if(t.width===void 0||t.height===void 0)throw new Error('drawRect() requires property "width" and "height".');if(t.width<=0||t.height<=0)return;let e=t.width,i=t.height,s=Kt(t.origin||xe).add(1,1).scale(g(e,i).scale(-.5)),c=[g(0,0),g(e,0),g(e,i),g(0,i)];if(t.radius){let n=Math.min(Math.min(e,i)/2,t.radius);c=[g(n,0),g(e-n,0),...Mt(g(e-n,n),n,n,270,360),g(e,n),g(e,i-n),...Mt(g(e-n,i-n),n,n,0,90),g(e-n,i),g(n,i),...Mt(g(n,i-n),n,n,90,180),g(0,i-n),g(0,n),...Mt(g(n,n),n,n,180,270)]}mt({...t,offset:s,pts:c,...t.gradient?{colors:t.horizontal?[t.gradient[0],t.gradient[1],t.gradient[1],t.gradient[0]]:[t.gradient[0],t.gradient[0],t.gradient[1],t.gradient[1]]}:{}})}o(rt,"drawRect");function Pt(t){let{p1:e,p2:i}=t;if(!e||!i)throw new Error('drawLine() requires properties "p1" and "p2".');let s=t.width||1,c=i.sub(e).unit().normal().scale(s*.5),n=[e.sub(c),e.add(c),i.add(c),i.sub(c)].map(d=>{var h,A;return{pos:Bt(d.x,d.y,0),uv:g(0),color:(h=t.color)!=null?h:I.WHITE,opacity:(A=t.opacity)!=null?A:1}});ue(n,[0,1,3,1,2,3],t.fixed,p.defTex,t.shader,t.uniform)}o(Pt,"drawLine");function Qe(t){let e=t.pts;if(!e)throw new Error('drawLines() requires property "pts".');if(!(e.length<2))if(t.radius&&e.length>=3){let i=e[0].dist(e[1]);for(let s=1;s<e.length-1;s++)i=Math.min(e[s].dist(e[s+1]),i);Math.min(t.radius,i/2),Pt({...t,p1:e[0],p2:e[1]});for(let s=1;s<e.length-2;s++){let c=e[s],n=e[s+1];Pt({...t,p1:c,p2:n})}Pt({...t,p1:e[e.length-2],p2:e[e.length-1]})}else for(let i=0;i<e.length-1;i++)Pt({...t,p1:e[i],p2:e[i+1]})}o(Qe,"drawLines");function Ye(t){if(!t.p1||!t.p2||!t.p3)throw new Error('drawPolygon() requires properties "p1", "p2" and "p3".');return mt({...t,pts:[t.p1,t.p2,t.p3]})}o(Ye,"drawTriangle");function Dt(t){if(!t.radius)throw new Error('drawCircle() requires property "radius".');t.radius!==0&&Ke({...t,radiusX:t.radius,radiusY:t.radius,angle:0})}o(Dt,"drawCircle");function Ke(t){var n,d;if(t.radiusX===void 0||t.radiusY===void 0)throw new Error('drawEllipse() requires properties "radiusX" and "radiusY".');if(t.radiusX===0||t.radiusY===0)return;let e=(n=t.start)!=null?n:0,i=(d=t.end)!=null?d:360,s=Mt(g(0),t.radiusX,t.radiusY,e,i,t.resolution);s.unshift(g(0));let c={...t,pts:s,radius:0,...t.gradient?{colors:[t.gradient[0],...Array(s.length-1).fill(t.gradient[1])]}:{}};if(i-e>=360&&t.outline){t.fill!==!1&&mt({...c,outline:null}),mt({...c,pts:s.slice(1),fill:!1});return}mt(c)}o(Ke,"drawEllipse");function mt(t){var i,s;if(!t.pts)throw new Error('drawPolygon() requires property "pts".');let e=t.pts.length;if(!(e<3)){if(et(),k(t.pos),vt(t.scale),gt(t.angle),k(t.offset),t.fill!==!1){let c=(i=t.color)!=null?i:I.WHITE,n=t.pts.map((h,A)=>{var f,V;return{pos:Bt(h.x,h.y,0),uv:g(0,0),color:t.colors&&(f=t.colors[A])!=null?f:c,opacity:(V=t.opacity)!=null?V:1}}),d=[...Array(e-2).keys()].map(h=>[0,h+1,h+2]).flat();ue(n,(s=t.indices)!=null?s:d,t.fixed,p.defTex,t.shader,t.uniform)}t.outline&&Qe({pts:[...t.pts,t.pts[0]],radius:t.radius,width:t.outline.width,color:t.outline.color,uniform:t.uniform,fixed:t.fixed}),W()}}o(mt,"drawPolygon");function qe(t,e,i){ht(),l.clear(l.STENCIL_BUFFER_BIT),l.enable(l.STENCIL_TEST),l.stencilFunc(l.NEVER,1,255),l.stencilOp(l.REPLACE,l.REPLACE,l.REPLACE),e(),ht(),l.stencilFunc(i,1,255),l.stencilOp(l.KEEP,l.KEEP,l.KEEP),t(),ht(),l.disable(l.STENCIL_TEST)}o(qe,"drawStenciled");function $r(t,e){qe(t,e,l.EQUAL)}o($r,"drawMasked");function ti(t,e){qe(t,e,l.NOTEQUAL)}o(ti,"drawSubtracted");function Oe(){return(p.viewport.width+p.viewport.height)/(p.width+p.height)}o(Oe,"getViewportScale");function ct(t){ht();let e=p.width,i=p.height;p.width=p.viewport.width,p.height=p.viewport.height,t(),ht(),p.width=e,p.height=i}o(ct,"drawUnscaled");function Je(t,e){e.pos&&(t.pos=t.pos.add(e.pos)),e.scale&&(t.scale=t.scale.scale(g(e.scale))),e.angle&&(t.angle+=e.angle),e.color&&(t.color=t.color.mult(e.color)),e.opacity&&(t.opacity*=e.opacity)}o(Je,"applyCharTransform");let ei=/\[(?<text>[^\]]*)\]\.(?<style>[\w\.]+)+/g;function ri(t){let e={},i=t.replace(ei,"$1"),s=0;for(let c of t.matchAll(ei)){let n=c.groups.style.split("."),d=c.index-s;for(let h=d;h<c.index+c.groups.text.length;h++)e[h]={localIdx:h-d,styles:n};s+=3+c.groups.style.length}return{charStyleMap:e,text:i}}o(ri,"compileStyledText");let ze={};function Vt(t){var ut,te,an,un,ln,hn,dn;if(t.text===void 0)throw new Error('formatText() requires property "text".');let e=Le(t.font);if(t.text===""||e instanceof F||!e)return{width:0,height:0,chars:[],opt:t};let{charStyleMap:i,text:s}=ri(t.text+""),c=s.split("");if(e instanceof FontFace||typeof e=="string"){let _=e instanceof FontFace?e.family:e,M=(ut=ze[_])!=null?ut:{font:{tex:new w(be,be),map:{},size:En},cursor:g(0)};ze[_]||(ze[_]=M),e=M.font;for(let q of c)if(!M.font.map[q]){let at=u.canvas2.getContext("2d");at.font=`${e.size}px ${_}`,at.clearRect(0,0,u.canvas2.width,u.canvas2.height),at.textBaseline="top",at.textAlign="left",at.fillStyle="rgb(255, 255, 255)",at.fillText(q,0,0);let ee=at.measureText(q),Gt=Math.ceil(ee.width),Qt=at.getImageData(0,0,Gt,e.size);if(M.cursor.x+Gt>be&&(M.cursor.x=0,M.cursor.y+=e.size,M.cursor.y>be))throw new Error("Font atlas exceeds character limit");e.tex.update(M.cursor.x,M.cursor.y,Qt),e.map[q]=new O(M.cursor.x,M.cursor.y,Gt,e.size),M.cursor.x+=Gt}}let n=t.size||e.size,d=g((te=t.scale)!=null?te:1).scale(n/e.size),h=(an=t.lineSpacing)!=null?an:0,A=(un=t.letterSpacing)!=null?un:0,f=0,V=0,E=0,v=[],b=[],N=0,z=null,K=null;for(;N<c.length;){let _=c[N];if(_===`
`)E+=n+h,v.push({width:f-A,chars:b}),z=null,K=null,f=0,b=[];else{let M=e.map[_];if(M){let q=M.w*d.x;t.width&&f+q>t.width&&(E+=n+h,z!=null&&(N-=b.length-z,_=c[N],M=e.map[_],q=M.w*d.x,b=b.slice(0,z-1),f=K),z=null,K=null,v.push({width:f-A,chars:b}),f=0,b=[]),b.push({tex:e.tex,width:M.w,height:M.h,quad:new O(M.x/e.tex.width,M.y/e.tex.height,M.w/e.tex.width,M.h/e.tex.height),ch:_,pos:g(f,E),opacity:(ln=t.opacity)!=null?ln:1,color:(hn=t.color)!=null?hn:I.WHITE,scale:g(d),angle:0}),_===" "&&(z=b.length,K=f),f+=q,V=Math.max(V,f),f+=A}}N++}v.push({width:f-A,chars:b}),E+=n,t.width&&(V=t.width);let Rt=[];for(let _ of v){let M=(V-_.width)*zn((dn=t.align)!=null?dn:"left");for(let q of _.chars){let at=e.map[q.ch],ee=Rt.length,Gt=new L(at.w*d.x*.5,at.h*d.y*.5);if(q.pos=q.pos.add(M,0).add(Gt),t.transform){let Qt=typeof t.transform=="function"?t.transform(ee,q.ch):t.transform;Qt&&Je(q,Qt)}if(i[ee]){let{styles:Qt,localIdx:rs}=i[ee];for(let is of Qt){let Er=t.styles[is],cn=typeof Er=="function"?Er(rs,q.ch):Er;cn&&Je(q,cn)}}Rt.push(q)}}return{width:V,height:E,chars:Rt,opt:t}}o(Vt,"formatText");function He(t){wt(Vt(t))}o(He,"drawText");function wt(t){var e;et(),k(t.opt.pos),gt(t.opt.angle),k(Kt((e=t.opt.origin)!=null?e:"topleft").add(1,1).scale(t.width,t.height).scale(-.5)),t.chars.forEach(i=>{bt({tex:i.tex,width:i.width,height:i.height,pos:i.pos,scale:i.scale,angle:i.angle,color:i.color,opacity:i.opacity,quad:i.quad,origin:"center",uniform:t.opt.uniform,shader:t.opt.shader,fixed:t.opt.fixed})}),W()}o(wt,"drawFormattedText");function ii(){var c;if(u.stretchToParent&&!fe()){let n=u.canvas.parentElement.offsetWidth,d=u.canvas.parentElement.offsetHeight;if(n!==u.lastParentWidth||d!==u.lastParentHeight){u.canvas.width=n*u.pixelDensity,u.canvas.height=d*u.pixelDensity,u.canvas.style.width=n+"px",u.canvas.style.height=d+"px";let h=Q(),A=Y();m.ev.onOnce("frameEnd",()=>{m.ev.trigger("resize",h,A,Q(),Y())})}u.lastParentWidth=n,u.lastParentHeight=d}let t=u.pixelDensity,e=l.drawingBufferWidth/t,i=l.drawingBufferHeight/t;if(fe()){let n=window.innerWidth,d=window.innerHeight,h=n/d,A=e/i;if(h>A){let f=window.innerHeight*A;p.viewport={x:(n-f)/2,y:0,width:f,height:d}}else{let f=window.innerWidth/A;p.viewport={x:0,y:(d-f)/2,width:n,height:f}}return}if(r.letterbox){if(!r.width||!r.height)throw new Error("Letterboxing requires width and height defined.");let n=e/i,d=r.width/r.height;if(n>d){r.stretch||(p.width=i*d,p.height=i);let h=i*d,A=i,f=(e-h)/2;l.scissor(f*t,0,h*t,A*t),l.viewport(f*t,0,h*t,i*t),p.viewport={x:f,y:0,width:h,height:i}}else{r.stretch||(p.width=e,p.height=e/d);let h=e,A=e/d,f=(i-A)/2;l.scissor(0,f*t,h*t,A*t),l.viewport(0,f*t,e*t,A*t),p.viewport={x:0,y:f,width:e,height:A}}return}if(r.stretch){if(!r.width||!r.height)throw new Error("Stretching requires width and height defined.");l.viewport(0,0,e*t,i*t),p.viewport={x:0,y:0,width:e,height:i};return}let s=(c=r.scale)!=null?c:1;p.width=e/s,p.height=i/s,l.viewport(0,0,e*t,i*t),p.viewport={x:0,y:0,width:e,height:i}}o(ii,"updateViewport");function Q(){return p.width}o(Q,"width");function Y(){return p.height}o(Y,"height");let X={},Jt={},kt={};function zt(t){return g((t.x-p.viewport.x)*Q()/p.viewport.width,(t.y-p.viewport.y)*Y()/p.viewport.height)}o(zt,"windowToContent");function ni(t){return g(t.x*p.viewport.width/p.width,t.y*p.viewport.height/p.height)}o(ni,"contentToView");function le(t,e){let i=zt(g(t,e));u.mouseStarted&&(u.mouseDeltaPos=i.sub(u.mousePos)),u.mousePos=i,u.mouseStarted=!0,u.isMouseMoved=!0}o(le,"setMousePos"),X.mousemove=t=>{le(t.offsetX,t.offsetY)},X.mousedown=t=>{let e=pn[t.button];e&&(u.mouseStates[e]="pressed")},X.mouseup=t=>{let e=pn[t.button];e&&(u.mouseStates[e]="released")},X.keydown=t=>{let e=fn[t.key]||t.key.toLowerCase();ws.includes(e)&&t.preventDefault(),e.length===1&&u.charInputted.push(t.key),e==="space"&&u.charInputted.push(" "),t.repeat?(u.isKeyPressedRepeat=!0,u.keyStates[e]="rpressed"):(u.isKeyPressed=!0,u.keyStates[e]="pressed"),u.numKeyDown++},X.keyup=t=>{let e=fn[t.key]||t.key.toLowerCase();u.keyStates[e]="released",u.isKeyReleased=!0,u.numKeyDown--},X.touchstart=t=>{t.preventDefault();let e=[...t.changedTouches];e.forEach(i=>{m.ev.trigger("onTouchStart",zt(g(i.clientX,i.clientY)),i)}),r.touchToMouse!==!1&&(le(e[0].clientX,e[0].clientY),u.mouseStates.left="pressed")},X.touchmove=t=>{t.preventDefault();let e=[...t.changedTouches];e.forEach(i=>{m.ev.trigger("onTouchMove",zt(g(i.clientX,i.clientY)),i)}),r.touchToMouse!==!1&&le(e[0].clientX,e[0].clientY)},X.touchend=t=>{[...t.changedTouches].forEach(e=>{m.ev.trigger("onTouchEnd",zt(g(e.clientX,e.clientY)),e)}),r.touchToMouse!==!1&&(u.mouseStates.left="released")},X.touchcancel=()=>{r.touchToMouse!==!1&&(u.mouseStates.left="released")},X.contextmenu=function(t){t.preventDefault()},Jt.visibilitychange=()=>{switch(document.visibilityState){case"visible":u.skipTime=!0,U.paused||B.ctx.resume();break;case"hidden":B.ctx.suspend();break}},kt.error=t=>{t.error?ye(t.error):ye(new Error(t.message))},kt.unhandledrejection=t=>ye(t.reason);for(let t in X)u.canvas.addEventListener(t,X[t]);for(let t in Jt)document.addEventListener(t,Jt[t]);for(let t in kt)window.addEventListener(t,kt[t]);function it(){return u.mousePos.clone()}o(it,"mousePos");function je(){return u.mouseDeltaPos.clone()}o(je,"mouseDeltaPos");function Ht(t="left"){return u.mouseStates[t]==="pressed"}o(Ht,"isMousePressed");function he(t="left"){return u.mouseStates[t]==="pressed"||u.mouseStates[t]==="down"}o(he,"isMouseDown");function de(t="left"){return u.mouseStates[t]==="released"}o(de,"isMouseReleased");function We(){return u.isMouseMoved}o(We,"isMouseMoved");function jt(t){return t===void 0?u.isKeyPressed:u.keyStates[t]==="pressed"}o(jt,"isKeyPressed");function Xe(t){return t===void 0?u.isKeyPressedRepeat:u.keyStates[t]==="pressed"||u.keyStates[t]==="rpressed"}o(Xe,"isKeyPressedRepeat");function Ze(t){return t===void 0?u.numKeyDown>0:u.keyStates[t]==="pressed"||u.keyStates[t]==="rpressed"||u.keyStates[t]==="down"}o(Ze,"isKeyDown");function ce(t){return t===void 0?u.isKeyReleased:u.keyStates[t]==="released"}o(ce,"isKeyReleased");function si(){return[...u.charInputted]}o(si,"charInputted");function Ae(){return u.time}o(Ae,"time");function _e(){return u.canvas.toDataURL()}o(_e,"screenshot");function $e(t){return t&&(u.canvas.style.cursor=t),u.canvas.style.cursor}o($e,"setCursor");function oi(t=!0){t?qn(u.canvas):On()}o(oi,"setFullscreen");function fe(){return Boolean(Jn())}o(fe,"isFullscreen");let U={inspect:!1,timeScale:1,showLog:!0,fps:()=>u.fpsCounter.fps,numFrames:()=>u.numFrames,stepFrame:mr,drawCalls:()=>p.drawCalls,clearLog:()=>m.logs=[],log:t=>{var i;let e=(i=r.logMax)!=null?i:Bs;m.logs.unshift(`${r.logTime?`[${Ae().toFixed(2)}].time `:""}[${t!=null&&t.toString?t.toString():t}].${t instanceof Error?"error":"info"}`),m.logs.length>e&&(m.logs=m.logs.slice(0,e))},error:t=>U.log(new Error(t.toString?t.toString():t)),curRecording:null,get paused(){return u.paused},set paused(t){u.paused=t,t?B.ctx.suspend():B.ctx.resume()}};function Z(){return u.dt*U.timeScale}o(Z,"dt");function ai(...t){return t.length>0&&(m.cam.pos=g(...t)),m.cam.pos.clone()}o(ai,"camPos");function ui(...t){return t.length>0&&(m.cam.scale=g(...t)),m.cam.scale.clone()}o(ui,"camScale");function li(t){return t!==void 0&&(m.cam.angle=t),m.cam.angle}o(li,"camRot");function hi(t=12){m.cam.shake=t}o(hi,"shake");function tr(t){return m.cam.transform.multVec2(t)}o(tr,"toScreen");function er(t){return m.cam.transform.invert().multVec2(t)}o(er,"toWorld");function rr(t){let e=new P;return t.pos&&(e=e.translate(t.pos)),t.scale&&(e=e.scale(t.scale)),t.angle&&(e=e.rotateZ(t.angle)),t.parent?e.mult(t.parent.transform):e}o(rr,"calcTransform");function pe(t){let e=new Map,i={},s=new Yt,c={id:ds(),hidden:!1,paused:!1,transform:new P,children:[],parent:null,add(n){let d=(()=>{if(Array.isArray(n))return pe(n);if(n.parent)throw new Error("Cannot add a game obj that already has a parent.");return n})();return d.parent=this,d.transform=rr(d),d.trigger("add",this),_t(()=>d.trigger("load")),this.children.push(d),d},readd(n){return this.remove(n),this.children.push(n),n},remove(n){let d=this.children.indexOf(n);d!==-1&&(n.parent=null,n.trigger("destroy"),this.children.splice(d,1))},removeAll(n){this.get().forEach(n,d=>this.remove(d))},update(){this.paused||(this.get().forEach(n=>n.update()),this.trigger("update"))},draw(){this.hidden||(et(),k(this.pos),vt(this.scale),gt(this.angle),this.get().forEach(n=>n.draw()),this.trigger("draw"),W())},drawInspect(){this.hidden||(et(),k(this.pos),vt(this.scale),gt(this.angle),this.get().forEach(n=>n.drawInspect()),this.trigger("drawInspect"),W())},use(n){if(!n)return;if(typeof n=="string")return this.use({id:n});n.id&&(this.unuse(n.id),e.set(n.id,{cleanups:[]}));let d=n.id?e.get(n.id):i,h=n.id?d.cleanups:[],A=o(()=>{if(n.require){for(let f of n.require)if(!this.c(f))throw new Error(`Component "${n.id}" requires component "${f}"`)}},"checkDeps");n.destroy&&h.push(n.destroy),n.require&&!this.exists()&&d.cleanups&&h.push(this.on("add",A));for(let f in n)if(!Ts.has(f)){if(typeof n[f]=="function"){let V=n[f].bind(this);if(Is.has(f)){h.push(this.on(f,V)),d[f]=V;continue}else d[f]=V}else d[f]=n[f];if(this[f]===void 0)Object.defineProperty(this,f,{get:()=>d[f],set:V=>d[f]=V,configurable:!0,enumerable:!0});else throw new Error(`Duplicate component property: "${f}"`)}this.exists()&&(A(),n.add&&n.add.call(this))},unuse(n){if(e.has(n)){let d=e.get(n);d.cleanups.forEach(h=>h());for(let h in d)delete d[h]}e.delete(n)},c(n){return e.get(n)},get(n){return this.children.filter(d=>n?d.is(n):!0).sort((d,h)=>{var A,f;return((A=d.z)!=null?A:0)-((f=h.z)!=null?f:0)})},getAll(n){return this.children.sort((d,h)=>{var A,f;return((A=d.z)!=null?A:0)-((f=h.z)!=null?f:0)}).flatMap(d=>[d,...d.getAll(n)]).filter(d=>n?d.is(n):!0)},isAncestorOf(n){return n.parent?n.parent===this||this.isAncestorOf(n.parent):!1},exists(){return m.root.isAncestorOf(this)},is(n){if(n==="*")return!0;if(Array.isArray(n)){for(let d of n)if(!this.c(d))return!1;return!0}else return this.c(n)!=null},on(n,d){return s.on(n,d.bind(this))},trigger(n,...d){s.trigger(n,...d),m.objEvents.trigger(n,this,...d)},destroy(){if(this.parent)this.parent.remove(this);else throw new Error("Cannot destroy parentless object.")},inspect(){let n={};for(let[d,h]of e)n[d]=h.inspect?h.inspect():null;return n},onUpdate(n){return this.on("update",n)},onDraw(n){return this.on("draw",n)},onDestroy(n){return this.on("destroy",n)},clearEvents(){s.clear()}};for(let n of t)c.use(n);return c}o(pe,"make");function Wt(t,e,i){return m.objEvents[t]||(m.objEvents[t]=new Ot),m.objEvents.on(t,(s,...c)=>{s.is(e)&&i(s,...c)})}o(Wt,"on");function ge(t,e){if(typeof t=="function"&&e===void 0){let i=$t([{update:t}]);return()=>i.destroy()}else if(typeof t=="string")return Wt("update",t,e)}o(ge,"onUpdate");function di(t,e){if(typeof t=="function"&&e===void 0){let i=$t([{draw:t}]);return()=>i.destroy()}else if(typeof t=="string")return Wt("draw",t,e)}o(di,"onDraw");function ci(t,e,i){return Wt("collide",t,(s,c,n)=>c.is(e)&&i(s,c,n))}o(ci,"onCollide");function Ai(t,e){return typeof t=="function"?ar(t):ge(t,i=>{if(!i.area)throw new Error("onClick() requires the object to have area() component");i.isClicked()&&e(i)})}o(Ai,"onClick");function fi(t,e,i){return ge(t,s=>{if(!s.area)throw new Error("onHover() requires the object to have area() component");s.isHovering()?e(s):i&&i(s)})}o(fi,"onHover");function ir(t,e){return new Promise(i=>{m.timers.push(new re(t,()=>{e&&e(),i()}))})}o(ir,"wait");function pi(t,e){let i=!1,s=o(()=>{i||(e(),ir(t,s))},"newF");return s(),()=>i=!0}o(pi,"loop");function nr(t,e){if(Array.isArray(t)){let i=t.map(s=>nr(s,e));return()=>i.forEach(s=>s())}return m.ev.on("input",()=>Ze(t)&&e())}o(nr,"onKeyDown");function nt(t,e){if(Array.isArray(t)){let i=t.map(s=>nt(s,e));return()=>i.forEach(s=>s())}else return typeof t=="function"?m.ev.on("input",()=>jt()&&t()):m.ev.on("input",()=>jt(t)&&e())}o(nt,"onKeyPress");function sr(t,e){if(Array.isArray(t)){let i=t.map(s=>sr(s,e));return()=>i.forEach(s=>s())}else return typeof t=="function"?m.ev.on("input",()=>jt()&&t()):m.ev.on("input",()=>Xe(t)&&e())}o(sr,"onKeyPressRepeat");function or(t,e){if(Array.isArray(t)){let i=t.map(s=>or(s,e));return()=>i.forEach(s=>s())}else return typeof t=="function"?m.ev.on("input",()=>ce()&&t()):m.ev.on("input",()=>ce(t)&&e())}o(or,"onKeyRelease");function gi(t,e){return typeof t=="function"?m.ev.on("input",()=>he()&&t(it())):m.ev.on("input",()=>he(t)&&e(it()))}o(gi,"onMouseDown");function ar(t,e){return typeof t=="function"?m.ev.on("input",()=>Ht()&&t(it())):m.ev.on("input",()=>Ht(t)&&e(it()))}o(ar,"onMousePress");function mi(t,e){return typeof t=="function"?m.ev.on("input",()=>de()&&t(it())):m.ev.on("input",()=>de(t)&&e(it()))}o(mi,"onMouseRelease");function Vi(t){return m.ev.on("input",()=>We()&&t(it(),je()))}o(Vi,"onMouseMove");function wi(t){return m.ev.on("input",()=>si().forEach(e=>t(e)))}o(wi,"onCharInput");function Ei(t){return m.ev.on("onTouchStart",t)}o(Ei,"onTouchStart");function yi(t){return m.ev.on("onTouchMove",t)}o(yi,"onTouchMove");function xi(t){return m.ev.on("onTouchEnd",t)}o(xi,"onTouchEnd");function ur(){nt("f1",()=>{U.inspect=!U.inspect}),nt("f2",()=>{U.clearLog()}),nt("f8",()=>{U.paused=!U.paused}),nt("f7",()=>{U.timeScale=St(ot(U.timeScale-.2,0,2),1)}),nt("f9",()=>{U.timeScale=St(ot(U.timeScale+.2,0,2),1)}),nt("f10",()=>{U.stepFrame()}),nt("f5",()=>{m.ev.onOnce("frameEnd",()=>oe("kaboom.png",_e()))}),nt("f6",()=>{U.curRecording?(U.curRecording.download(),U.curRecording=null):U.curRecording=pr()})}o(ur,"enterDebugMode");function lr(){nt("b",Ne)}o(lr,"enterBurpMode");function vi(t){return t!==void 0&&(m.gravity=t),m.gravity}o(vi,"gravity");function Xt(...t){return{id:"pos",pos:g(...t),moveBy(...e){this.pos=this.pos.add(...e)},move(...e){this.moveBy(g(...e).scale(Z()))},moveTo(...e){if(typeof e[0]=="number"&&typeof e[1]=="number")return this.moveTo(g(e[0],e[1]),e[2]);let i=e[0],s=e[1];if(s===void 0){this.pos=g(i);return}let c=i.sub(this.pos);if(c.len()<=s*Z()){this.pos=g(i);return}this.move(c.unit().scale(s))},worldPos(){return this.parent?this.parent.transform.multVec2(this.pos):this.pos},screenPos(){return this.fixed?this.pos:tr(this.pos)},inspect(){return`(${Math.round(this.pos.x)}, ${Math.round(this.pos.y)})`},drawInspect(){Dt({color:T(255,0,0),radius:4/Oe()})}}}o(Xt,"pos");function Zt(...t){return t.length===0?Zt(1):{id:"scale",scale:g(...t),scaleTo(...e){this.scale=g(...e)},inspect(){return typeof this.scale=="number"?`${St(this.scale,2)}`:`(${St(this.scale.x,2)}, ${St(this.scale.y,2)})`}}}o(Zt,"scale");function bi(t){return{id:"rotate",angle:t!=null?t:0,rotate(e){this.rotateBy(e*Z())},rotateBy(e){this.angle+=e},inspect(){return`${Math.round(this.angle)}`}}}o(bi,"rotate");function Si(...t){return{id:"color",color:T(...t),inspect(){return this.color.toString()}}}o(Si,"color");function St(t,e){return Number(t.toFixed(e))}o(St,"toFixed");function Ri(t){return{id:"opacity",opacity:t!=null?t:1,inspect(){return`${St(this.opacity,2)}`}}}o(Ri,"opacity");function me(t){if(!t)throw new Error("Please define an origin");return{id:"origin",origin:t,inspect(){return typeof this.origin=="string"?this.origin:this.origin.toString()}}}o(me,"origin");function Bi(t){return{id:"z",z:t,inspect(){return`${this.z}`}}}o(Bi,"z");function Fi(t,e){return{id:"follow",require:["pos"],follow:{obj:t,offset:e!=null?e:g(0)},add(){t.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))},update(){t.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))}}}o(Fi,"follow");function Ci(t,e){let i=typeof t=="number"?L.fromAngle(t):t.unit();return{id:"move",require:["pos"],update(){this.move(i.scale(e))}}}o(Ci,"move");function hr(t={}){let e=0,i=!1;return{id:"outview",require:["pos","area"],isOutOfView(){var n;let s=g((n=t.offset)!=null?n:0),c=J.fromPoints(g(0,0).sub(s),g(Q(),Y()).add(s));return!In(this.screenArea().bbox(),c)},onExitView(s){return this.on("exitView",s)},onEnterView(s){return this.on("enterView",s)},update(){if(this.isOutOfView()){if(i||(this.trigger("exitView"),i=!0),t.delay&&(e+=Z(),e<t.delay))return;t.hide&&(this.hidden=!0),t.pause&&(this.paused=!0),t.destroy&&this.destroy()}else i&&(this.trigger("enterView"),i=!1),e=0,t.hide&&(this.hidden=!1),t.pause&&(this.paused=!1)},inspect(){return this.isOutOfView()}}}o(hr,"outview");function Ti(t={}){return{...hr({destroy:!0,onExitView:t.onCleanup,offset:t.offset,delay:t.delay}),id:"cleanup"}}o(Ti,"cleanup");function Ii(t={}){var i,s,c,n,d;let e=[];return{id:"area",colliding:{},collisionIgnore:(i=t.collisionIgnore)!=null?i:[],add(){this.area.cursor&&e.push(this.onHover(()=>$e(this.area.cursor))),e.push(this.onCollisionActive((h,A)=>{this.colliding[h.id]||this.trigger("collide",h,A),this.colliding[h.id]=A}))},update(){for(let h in this.colliding){let A=this.colliding[h];this.checkCollision(A.target)||(delete this.colliding[h],this.trigger("collisionEnd",A.target,A))}},drawInspect(){let h=this.localArea();et(),vt(this.area.scale),k(this.area.offset);let A={outline:{width:4/Oe(),color:T(0,0,255)},origin:this.origin,fill:!1,fixed:this.fixed};h instanceof J?rt({...A,pos:h.pos,width:h.width,height:h.height}):h instanceof se?mt({...A,pts:h.pts}):h instanceof Se&&Dt({...A,pos:h.center,radius:h.radius}),W()},destroy(){e.forEach(h=>h())},area:{shape:(s=t.shape)!=null?s:null,scale:(c=t.scale)!=null?c:g(1),offset:(n=t.offset)!=null?n:g(0),cursor:(d=t.cursor)!=null?d:null},isClicked(){return Ht()&&this.isHovering()},isHovering(){let h=this.fixed?it():er(it());return this.hasPoint(h)},checkCollision(h){if(this===h||!h.area||!h.exists())return null;let A=this.worldArea(),f=h.worldArea();return kn(A,f)},isColliding(h){let A=this.checkCollision(h);return A&&!A.isZero()},isTouching(h){return Boolean(this.checkCollision(h))},onClick(h){return this.onUpdate(()=>{this.isClicked()&&h()})},onHover(h,A){return this.onUpdate(()=>{this.isHovering()?h():A&&A()})},onCollide(h,A){if(typeof h=="function"&&A===void 0)return this.on("collide",h);if(typeof h=="string")return this.onCollide((f,V)=>{f.is(h)&&A(f,V)})},onCollisionActive(h,A){if(typeof h=="function"&&A===void 0)return this.on("collisionActive",h);if(typeof h=="string")return this.on("collisionActive",(f,V)=>f.is(h)&&A(f,V))},onCollisionEnd(h,A){if(typeof h=="function"&&A===void 0)return this.on("collisionEnd",h);if(typeof h=="string")return this.on("collisionEnd",f=>f.is(h)&&A(f))},hasPoint(h){return Dn(this.worldArea(),Tt.fromVec2(h))},pushOut(h){let A=this.checkCollision(h);A&&(this.pos=this.pos.add(A))},pushOutAll(){m.root.getAll().forEach(this.pushOut)},localArea(){return this.area.shape?this.area.shape:this.renderArea()},worldArea(){var f;let h=this.localArea(),A=this.transform.scale(g((f=this.area.scale)!=null?f:1)).translate(this.area.offset);if(h instanceof J){let V=h.bbox(),E=Kt(this.origin||xe).add(1,1).scale(-.5).scale(V.width,V.height);A=A.translate(E)}return h.transform(A)},screenArea(){let h=this.worldArea();return this.fixed?h:h.transform(m.cam.transform)}}}o(Ii,"area");function Lt(t){return{color:t.color,opacity:t.opacity,origin:t.origin,outline:t.outline,fixed:t.fixed,shader:t.shader,uniform:t.uniform}}o(Lt,"getRenderProps");function Ve(t,e={}){var n;let i=null,s=null;if(!t)throw new Error("Please pass the resource name or data to sprite()");let c=o((d,h,A,f)=>{let V=g(1,1);return A&&f?(V.x=A/(d.width*h.w),V.y=f/(d.height*h.h)):A?(V.x=A/(d.width*h.w),V.y=V.x):f&&(V.y=f/(d.height*h.h),V.x=V.y),V},"calcTexScale");return{id:"sprite",width:0,height:0,frame:e.frame||0,quad:e.quad||new O(0,0,1,1),animSpeed:(n=e.animSpeed)!=null?n:1,draw(){!i||Ge({...Lt(this),sprite:i,frame:this.frame,quad:this.quad,flipX:e.flipX,flipY:e.flipY,tiled:e.tiled,width:e.width,height:e.height})},update(){if(!i){let h=ke(t);if(!h||!h.data)return;let A=h.data.frames[0].clone();e.quad&&(A=A.scale(e.quad));let f=c(h.data.tex,A,e.width,e.height);this.width=h.data.tex.width*A.w*f.x,this.height=h.data.tex.height*A.h*f.y,e.anim&&this.play(e.anim),i=h.data,this.trigger("spriteLoaded",i)}if(!s)return;let d=i.anims[s.name];if(typeof d=="number"){this.frame=d;return}if(d.speed===0)throw new Error("Sprite anim speed cannot be 0");s.timer+=Z()*this.animSpeed,s.timer>=1/s.speed&&(s.timer=0,d.from>d.to?(this.frame--,this.frame<d.to&&(s.loop?this.frame=d.from:(this.frame++,s.onEnd(),this.stop()))):(this.frame++,this.frame>d.to&&(s.loop?this.frame=d.from:(this.frame--,s.onEnd(),this.stop()))))},play(d,h={}){var f,V,E,v,b,N,z;if(!i){this.on("spriteLoaded",()=>{this.play(d,h)});return}let A=i.anims[d];if(!A)throw new Error(`Anim not found: ${d}`);s&&this.stop(),s=typeof A=="number"?{name:d,timer:0,loop:!1,pingpong:!1,speed:0,onEnd:()=>{}}:{name:d,timer:0,loop:(V=(f=h.loop)!=null?f:A.loop)!=null?V:!1,pingpong:(v=(E=h.pingpong)!=null?E:A.pingpong)!=null?v:!1,speed:(N=(b=h.speed)!=null?b:A.speed)!=null?N:10,onEnd:(z=h.onEnd)!=null?z:()=>{}},this.frame=typeof A=="number"?A:A.from,this.trigger("animStart",d)},stop(){if(!s)return;let d=s.name;s=null,this.trigger("animEnd",d)},numFrames(){return i?i.frames.length:0},curAnim(){return s==null?void 0:s.name},flipX(d){e.flipX=d},flipY(d){e.flipY=d},onAnimEnd(d,h){return this.on("animEnd",A=>{A===d&&h()})},onAnimStart(d,h){return this.on("animStart",A=>{A===d&&h()})},renderArea(){return new J(g(0),this.width,this.height)},inspect(){if(typeof t=="string")return`"${t}"`}}}o(Ve,"sprite");function Ui(t,e={}){var s;function i(c){var d,h;let n=Vt({...Lt(c),text:c.text+"",size:c.textSize,font:c.font,width:e.width&&c.width,align:c.align,letterSpacing:c.letterSpacing,lineSpacing:c.lineSpacing,transform:c.textTransform,styles:c.textStyles});return e.width||(c.width=n.width/(((d=c.scale)==null?void 0:d.x)||1)),c.height=n.height/(((h=c.scale)==null?void 0:h.y)||1),n}return o(i,"update"),{id:"text",text:t,textSize:(s=e.size)!=null?s:Rs,font:e.font,width:e.width,height:0,align:e.align,lineSpacing:e.lineSpacing,letterSpacing:e.letterSpacing,textTransform:e.transform,textStyles:e.styles,add(){_t(()=>i(this))},draw(){wt(i(this))},renderArea(){return new J(g(0),this.width,this.height)}}}o(Ui,"text");function Mi(t,e,i={}){return{id:"rect",width:t,height:e,radius:i.radius||0,draw(){rt({...Lt(this),width:this.width,height:this.height,radius:this.radius})},renderArea(){return new J(g(0),this.width,this.height)},inspect(){return`${Math.ceil(this.width)}, ${Math.ceil(this.height)}`}}}o(Mi,"rect");function Pi(t,e){return{id:"rect",width:t,height:e,draw(){bt({...Lt(this),width:this.width,height:this.height})},renderArea(){return new J(g(0),this.width,this.height)},inspect(){return`${Math.ceil(this.width)}, ${Math.ceil(this.height)}`}}}o(Pi,"uvquad");function Di(t){return{id:"circle",radius:t,draw(){Dt({...Lt(this),radius:this.radius})},renderArea(){return new Se(g(0),this.radius)},inspect(){return`${Math.ceil(this.radius)}`}}}o(Di,"circle");function ki(t=1,e=T(0,0,0)){return{id:"outline",outline:{width:t,color:e}}}o(ki,"outline");function dr(t,e){let i=new Ot;return t&&e&&i.pushd(new re(t,e)),{id:"timer",wait(s,c){return i.pushd(new re(s,c))},update(){i.forEach((s,c)=>{s.tick(Z())&&i.delete(c)})}}}o(dr,"timer");let jn=640,Wn=65536;function Li(t={}){var h,A,f,V;let e=0,i=null,s=null,c=!0,n=!1,d=[];return{id:"body",require:["pos","area"],jumpForce:(h=t.jumpForce)!=null?h:jn,gravityScale:(A=t.gravityScale)!=null?A:1,isStatic:(f=t.isStatic)!=null?f:!1,mass:(V=t.mass)!=null?V:0,add(){d.push(this.onCollisionActive((E,v)=>{if(!E.is("body")||v.resolved||this.isStatic&&E.isStatic)return;v.resolved=!0;let b=!this.isStatic&&E.isStatic?v:v.reverse();b.source.pos=b.source.pos.add(b.displacement),b.source.transform=rr(b.source),b.source.trigger("collisionResolve",b),b.target.trigger("collisionResolve",b.reverse())})),d.push(this.onCollisionResolve(E=>{m.gravity&&(E.isBottom()&&this.isFalling()?(e=0,i=E.target,s=E.target.pos,n?n=!1:(c=!0,this.trigger("ground",i))):E.isTop()&&this.isRising()&&(e=0,this.trigger("headbutt",E.target)))}))},update(){var v;if(!m.gravity||this.isStatic)return;if(n&&(i=null,s=null,this.trigger("fallOff"),n=!1),i)if(!this.isTouching(i)||!i.exists()||!i.is("body"))n=!0;else{i.pos.eq(s)||this.moveBy(i.pos.sub(s)),s=i.pos;return}let E=e;e+=m.gravity*this.gravityScale*Z(),e=Math.min(e,(v=t.maxVelocity)!=null?v:Wn),E<0&&e>=0&&this.trigger("fall"),this.move(0,e)},destroy(){d.forEach(E=>E())},onCollisionResolve(E){return this.on("collisionResolve",E)},curPlatform(){return i},isGrounded(){return i!==null},isFalling(){return e>0},isRising(){return e<0},jump(E){i=null,s=null,e=-E||-this.jumpForce},doubleJump(E){this.isGrounded()?this.jump(E):c&&(c=!1,this.jump(E),this.trigger("doubleJump"))},onGround(E){return this.on("ground",E)},onFall(E){return this.on("fall",E)},onFallOff(E){return this.on("fallOff",E)},onHeadbutt(E){return this.on("headbutt",E)},onDoubleJump(E){return this.on("doubleJump",E)}}}o(Li,"body");function Ni(t,e={}){return{id:"shader",shader:t,uniform:e}}o(Ni,"shader");function Gi(){return{id:"fixed",fixed:!0}}o(Gi,"fixed");function cr(){return{id:"stay",stay:!0}}o(cr,"stay");function Qi(t){if(t==null)throw new Error("health() requires the initial amount of hp");return{id:"health",hurt(e=1){this.setHP(t-e),this.trigger("hurt")},heal(e=1){this.setHP(t+e),this.trigger("heal")},hp(){return t},setHP(e){t=e,t<=0&&this.trigger("death")},onHurt(e){return this.on("hurt",e)},onHeal(e){return this.on("heal",e)},onDeath(e){return this.on("death",e)},inspect(){return`${t}`}}}o(Qi,"health");function Yi(t,e={}){var n;if(t==null)throw new Error("lifespan() requires time");let i=0,s=(n=e.fade)!=null?n:0,c=Math.max(t-s,0);return{id:"lifespan",update(){i+=Z(),i>=c&&(this.opacity=Fe(i,c,t,1,0)),i>=t&&this.destroy()}}}o(Yi,"lifespan");function Ki(t,e,i){if(!t)throw new Error("state() requires an initial state");let s={};function c(A){s[A]||(s[A]={enter:new At,leave:new At,update:new At,draw:new At})}o(c,"initStateEvents");function n(A,f,V){return c(f),s[f][A].add(V)}o(n,"on");function d(A,f,...V){c(f),s[f][A].trigger(...V)}o(d,"trigger");let h=!1;return{id:"state",state:t,enterState(A,...f){if(h=!0,e&&!e.includes(A))throw new Error(`State not found: ${A}`);let V=this.state;if(i){if(!(i!=null&&i[V]))return;let E=typeof i[V]=="string"?[i[V]]:i[V];if(!E.includes(A))throw new Error(`Cannot transition state from "${V}" to "${A}". Available transitions: ${E.map(v=>`"${v}"`).join(", ")}`)}d("leave",V,...f),this.state=A,d("enter",A,...f),d("enter",`${V} -> ${A}`,...f)},onStateTransition(A,f,V){return n("enter",`${A} -> ${f}`,V)},onStateEnter(A,f){return n("enter",A,f)},onStateUpdate(A,f){return n("update",A,f)},onStateDraw(A,f){return n("draw",A,f)},onStateLeave(A,f){return n("leave",A,f)},update(){h||(d("enter",t),h=!0),d("update",this.state)},draw(){d("draw",this.state)},inspect(){return this.state}}}o(Ki,"state");function _t(t){x.loaded?t():m.ev.on("load",t)}o(_t,"onLoad");function qi(t,e){m.scenes[t]=e}o(qi,"scene");function Oi(t,...e){if(!m.scenes[t])throw new Error(`Scene not found: ${t}`);m.ev.onOnce("frameEnd",()=>{m.ev=new Yt,m.objEvents=new Yt,m.root.get().forEach(i=>{i.stay||m.root.remove(i)}),m.root.clearEvents(),m.timers=new Ot,m.cam={pos:null,scale:g(1),angle:0,shake:0,transform:new P},m.gravity=0,m.scenes[t](...e),r.debug!==!1&&ur(),r.burp&&lr()})}o(Oi,"go");function Ji(t,e){try{return JSON.parse(window.localStorage[t])}catch{return e?(Ar(t,e),e):null}}o(Ji,"getData");function Ar(t,e){window.localStorage[t]=JSON.stringify(e)}o(Ar,"setData");function fr(t){let e=t(Nt);for(let i in e)Nt[i]=e[i],r.global!==!1&&(window[i]=e[i]);return Nt}o(fr,"plug");function we(){return g(Q()/2,Y()/2)}o(we,"center");function zi(t,e){return{id:"grid",gridPos:e.clone(),setGridPos(...i){let s=g(...i);this.gridPos=s.clone(),this.pos=g(this.gridPos.x*t.gridWidth(),this.gridPos.y*t.gridHeight())},moveLeft(){this.setGridPos(this.gridPos.add(g(-1,0)))},moveRight(){this.setGridPos(this.gridPos.add(g(1,0)))},moveUp(){this.setGridPos(this.gridPos.add(g(0,-1)))},moveDown(){this.setGridPos(this.gridPos.add(g(0,1)))}}}o(zi,"grid");function Hi(t,e){var n;if(!e.width||!e.height)throw new Error("Must provide level grid width & height.");let i=$t([Xt((n=e.pos)!=null?n:g(0))]),s=0,c={id:"level",gridWidth(){return e.width},gridHeight(){return e.height},getPos(...d){let h=g(...d);return g(h.x*e.width,h.y*e.height)},spawn(d,...h){let A=g(...h),f=(()=>{if(e[d]){if(typeof e[d]!="function")throw new Error("Level symbol def must be a function returning a component list");return e[d](A)}else if(e.any)return e.any(d,A)})();if(!f)return;let V=g(A.x*e.width,A.y*e.height);for(let E of f)if(E.id==="pos"){V.x+=E.pos.x,V.y+=E.pos.y;break}return f.push(Xt(V)),f.push(zi(this,A)),i.add(f)},levelWidth(){return s*e.width},levelHeight(){return t.length*e.height}};return i.use(c),t.forEach((d,h)=>{let A=d.split("");s=Math.max(A.length,s),A.forEach((f,V)=>{i.spawn(f,g(V,h))})}),i}o(Hi,"addLevel");function pr(t){let e=u.canvas.captureStream(t),i=B.ctx.createMediaStreamDestination();B.masterNode.connect(i);let s=new MediaRecorder(e),c=[];return s.ondataavailable=n=>{n.data.size>0&&c.push(n.data)},s.onerror=()=>{B.masterNode.disconnect(i),e.getTracks().forEach(n=>n.stop())},s.start(),{resume(){s.resume()},pause(){s.pause()},stop(){return s.stop(),B.masterNode.disconnect(i),e.getTracks().forEach(n=>n.stop()),new Promise(n=>{s.onstop=()=>{n(new Blob(c,{type:"video/mp4"}))}})},download(n="kaboom.mp4"){this.stop().then(d=>Sr(n,d))}}}o(pr,"record");function ji(){return document.activeElement===u.canvas}o(ji,"isFocused");function Wi(t){t.destroy()}o(Wi,"destroy");let $t=m.root.add.bind(m.root),Xn=m.root.readd.bind(m.root),Zn=m.root.removeAll.bind(m.root),_n=m.root.get.bind(m.root),Xi=m.root.getAll.bind(m.root);function gr(t=2,e=1){let i=0;return{id:"explode",require:["scale"],update(){let s=Math.sin(i*t)*e;s<0&&this.destroy(),this.scale=g(s),i+=Z()}}}o(gr,"explode");let $n=pt(null,ms),ts=pt(null,Vs);function Zi(t,e={}){var d,h;let i=$t([Xt(t),cr()]),s=(e.speed||1)*5,c=e.scale||1;i.add([Ve(ts),Zt(0),me("center"),gr(s,c),...((d=e.boomComps)!=null?d:()=>[])()]);let n=i.add([Ve($n),Zt(0),me("center"),dr(.4/s,()=>n.use(gr(s,c))),...((h=e.kaComps)!=null?h:()=>[])()]);return n.onDestroy(()=>i.destroy()),i}o(Zi,"addKaboom");function mr(){m.timers.forEach((t,e)=>{t.time-=Z(),t.time<=0&&(t.action(),m.timers.delete(e))}),m.root.update()}o(mr,"updateFrame");let es=64;class Ee{constructor(e,i,s,c=!1){y(this,"source");y(this,"target");y(this,"displacement");y(this,"resolved",!1);this.source=e,this.target=i,this.displacement=s,this.resolved=c}reverse(){return new Ee(this.target,this.source,this.displacement.scale(-1),this.resolved)}isLeft(){return this.displacement.x>0}isRight(){return this.displacement.x<0}isTop(){return this.displacement.y>0}isBottom(){return this.displacement.y<0}}o(Ee,"Collision");function _i(){let t={},e=r.hashGridSize||es,i=new P,s=[];function c(n){if(s.push(i),n.pos&&(i=i.translate(n.pos)),n.scale&&(i=i.scale(n.scale)),n.angle&&(i=i.rotateZ(n.angle)),n.transform=i.clone(),n.c("area")&&!n.paused){let d=n,h=d.worldArea().bbox(),A=Math.floor(h.pos.x/e),f=Math.floor(h.pos.y/e),V=Math.ceil((h.pos.x+h.width)/e),E=Math.ceil((h.pos.y+h.height)/e),v=new Set;for(let b=A;b<=V;b++)for(let N=f;N<=E;N++)if(!t[b])t[b]={},t[b][N]=[d];else if(!t[b][N])t[b][N]=[d];else{let z=t[b][N];for(let K of z){if(!K.exists()||v.has(K.id))continue;for(let ut of d.collisionIgnore)K.is(ut);for(let ut of K.collisionIgnore)d.is(ut);let Rt=d.checkCollision(K);if(Rt&&!Rt.isZero()){let ut=new Ee(d,K,Rt);d.trigger("collisionActive",K,ut);let te=ut.reverse();te.resolved=ut.resolved,K.trigger("collisionActive",d,te)}v.add(K.id)}z.push(d)}}n.get().forEach(c),i=s.pop()}o(c,"checkObj"),c(m.root)}o(_i,"checkFrame");function $i(){var i;let t=m.cam,e=L.fromAngle(ne(0,360)).scale(t.shake);t.shake=ie(t.shake,0,5*Z()),t.transform=new P().translate(we()).scale(t.scale).rotateZ(t.angle).translate(((i=t.pos)!=null?i:we()).scale(-1).add(e)),m.root.draw(),ht()}o($i,"drawFrame");function tn(){let t=C();ct(()=>{let e=Q()/2,i=24,s=g(Q()/2,Y()/2).sub(g(e/2,i/2));rt({pos:g(0),width:Q(),height:Y(),color:T(0,0,0)}),rt({pos:s,width:e,height:i,fill:!1,outline:{width:4}}),rt({pos:s,width:e*t,height:i})}),m.ev.trigger("loading",t)}o(tn,"drawLoadScreen");function Vr(t,e){ct(()=>{let i=g(8);et(),k(t);let s=Vt({text:e,font:ve,size:16,pos:i,color:T(255,255,255),fixed:!0}),c=s.width+i.x*2,n=s.height+i.x*2;t.x+c>=Q()&&k(g(-c,0)),t.y+n>=Y()&&k(g(0,-n)),rt({width:c,height:n,color:T(0,0,0),radius:4,opacity:.8,fixed:!0}),wt(s),W()})}o(Vr,"drawInspectText");function en(){if(U.inspect){let t=null;for(let e of Xi())if(e.c("area")&&e.isHovering()){t=e;break}if(m.root.drawInspect(),t){let e=[],i=t.inspect();for(let s in i)i[s]?e.push(`${s}: ${i[s]}`):e.push(`${s}`);Vr(ni(it()),e.join(`
`))}Vr(g(8),`FPS: ${U.fps()}`)}U.paused&&ct(()=>{et(),k(Q(),0),k(-8,8);let t=32;rt({width:t,height:t,origin:"topright",color:T(0,0,0),opacity:.8,radius:4,fixed:!0});for(let e=1;e<=2;e++)rt({width:4,height:t*.6,origin:"center",pos:g(-t/3*e,t*.5),color:T(255,255,255),radius:2,fixed:!0});W()}),U.timeScale!==1&&ct(()=>{et(),k(Q(),Y()),k(-8,-8);let t=8,e=Vt({text:U.timeScale.toFixed(1),font:ve,size:16,color:T(255,255,255),pos:g(-t),origin:"botright",fixed:!0});rt({width:e.width+t*2+t*4,height:e.height+t*2,origin:"botright",color:T(0,0,0),opacity:.8,radius:4,fixed:!0});for(let i=0;i<2;i++){let s=U.timeScale<1;Ye({p1:g(-e.width-t*(s?2:3.5),-t),p2:g(-e.width-t*(s?2:3.5),-t-e.height),p3:g(-e.width-t*(s?3.5:2),-t-e.height/2),pos:g(-i*t*1+(s?-t*.5:0),0),color:T(255,255,255),fixed:!0})}wt(e),W()}),U.curRecording&&ct(()=>{et(),k(0,Y()),k(24,-24),Dt({radius:12,color:T(255,0,0),opacity:vr(0,1,Ae()*4),fixed:!0}),W()}),U.showLog&&m.logs.length>0&&ct(()=>{et(),k(0,Y()),k(8,-8);let t=8,e=Vt({text:m.logs.join(`
`),font:ve,pos:g(t,-t),origin:"botleft",size:16,width:Q()*.6,lineSpacing:t/2,fixed:!0,styles:{time:{color:T(127,127,127)},info:{color:T(255,255,255)},error:{color:T(255,0,127)}}});rt({width:e.width+t*2,height:e.height+t*2,origin:"botleft",color:T(0,0,0),radius:4,opacity:.8,fixed:!0}),wt(e),W()})}o(en,"drawDebug"),r.debug!==!1&&ur(),r.burp&&lr();function rn(t){m.ev.on("loading",t)}o(rn,"onLoading");function nn(t){m.ev.on("resize",t)}o(nn,"onResize");function sn(t){m.ev.on("error",t)}o(sn,"onError");function ye(t){wr(()=>{ct(()=>{let e=Q(),i=Y(),s={size:24,width:e-32*2,letterSpacing:4,lineSpacing:4,font:ve,fixed:!0};rt({width:e,height:i,color:T(0,0,255),fixed:!0});let c=Vt({...s,text:t.name,pos:g(32),color:T(255,128,0),fixed:!0});wt(c),He({...s,text:t.message,pos:g(32,32+c.height+16),fixed:!0}),W(),m.ev.trigger("error",t)})})}o(ye,"handleErr");function wr(t){u.loopID!==null&&cancelAnimationFrame(u.loopID);let e=o(i=>{if(u.stopped)return;if(document.visibilityState!=="visible"){u.loopID=requestAnimationFrame(e);return}let s=i/1e3,c=s-u.realTime;u.realTime=s,u.skipTime||(u.dt=c,u.time+=Z(),u.fpsCounter.tick(u.dt)),u.skipTime=!1,u.numFrames++,zr(),t(),Hr();for(let n in u.keyStates)u.keyStates[n]=Br(u.keyStates[n]);for(let n in u.mouseStates)u.mouseStates[n]=Br(u.mouseStates[n]);u.charInputted=[],u.isMouseMoved=!1,u.isKeyPressed=!1,u.isKeyPressedRepeat=!1,u.isKeyReleased=!1,u.loopID=requestAnimationFrame(e),m.ev.trigger("frameEnd")},"frame");e(0)}o(wr,"run");function on(){m.ev.onOnce("frameEnd",()=>{u.stopped=!0,l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT|l.STENCIL_BUFFER_BIT);let t=l.getParameter(l.MAX_TEXTURE_IMAGE_UNITS);for(let e=0;e<t;e++)l.activeTexture(l.TEXTURE0+e),l.bindTexture(l.TEXTURE_2D,null),l.bindTexture(l.TEXTURE_CUBE_MAP,null);l.bindBuffer(l.ARRAY_BUFFER,null),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,null),l.bindRenderbuffer(l.RENDERBUFFER,null),l.bindFramebuffer(l.FRAMEBUFFER,null),a.forEach(e=>e()),l.deleteBuffer(p.vbuf),l.deleteBuffer(p.ibuf);for(let e in X)u.canvas.removeEventListener(e,X[e]);for(let e in Jt)document.removeEventListener(e,Jt[e]);for(let e in kt)window.removeEventListener(e,kt[e])})}o(on,"quit"),ft("sink",cs,6,8,{chars:"\u2588\u263A\u263B\u2665\u2666\u2663\u2660\u25CF\u25CB\u25AA\u25A1\u25A0\u25D8\u266A\u266B\u2261\u25BA\u25C4\u2302\xDE\xC0\xDF\xD7\xA5\u2191\u2193\u2192\u2190\u25CC\u25CF\u25BC\u25B2 !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u03A7\u2591\u2592\u2593\u1E00\u1E01\u1E02\u2502\u252C\u2524\u250C\u2510\u1E03\u1E04\u253C\u1E05\u1E06\u1E07\u1E08\u1E09\u1E0A\u1E0B\u1E0C\u2500\u251C\u2534\u2514\u2518\u1E0D\u1E0E\u205E\u1E0F\u1E10\u1E11\u1E12\u1E13\u1E14\u1E15\u1E16\u1E17\u1E18\u2584\u1E19\u1E1A\u1E1B\u1E1C\u2026\u1E1D\u1E1E\u1E1F\u1E20\u1E21\u1E22\u1E23\u1E24\u1E25\u1E26\u258C\u2590\u1E27\u1E28\u1E29\u1E2A\u1E2B\u1E2C\u1E2D\u1E2E\u1E2F\u1E30\u1E31\u1E32\u1E33\u1E34\u1E35\u1E36\u1E37\u1E38\u1E39\u1E3A\u1E3B\u1E3C\u1E3D\u1E3E\u1E3F\u1E40\u1E41\u1E42\u1E43\u1E44\u1E45\u1E46\u1E47\u1E48\u1E49\u1E4A\u1E4B\u1E4C\u1E4D\u1E4E\u1E4F\u1E50\u1E51\u1E52\u1E53\u1E54\u1E55\u1E56\u1E57\u1E58\u1E59\u1E5A\u1E5B\u1E5C\u1E5D\u1E5E\u1E5F\u1E60\u1E61\u1E62\u1E63\u1E64\u1E65\u1E66\u1E67\u1E68\u1E69\u1E6A\u1E6B\u1E6C\u1E6D\u1E6E\u1E6F\u1E70\u1E71\u1E72\u1E73\u1E74\u1E75\u1E76\u1E77\u1E78\u1E79\u1E7A\u1E7B\u1E7C"}),ft("sinko",As,8,10),wr(()=>{let t=C();x.loaded||t===1&&(x.loaded=!0,m.ev.trigger("load")),!x.loaded&&r.loadingScreen!==!1?tn():(m.ev.trigger("input"),U.paused||mr(),_i(),$i(),r.debug!==!1&&en())});let Nt={loadRoot:$,loadProgress:C,loadSprite:pt,loadSpriteAtlas:Ie,loadSound:Nr,loadBitmapFont:ft,loadFont:It,loadShader:Lr,loadAseprite:kr,loadPedit:Dr,loadBean:Gr,loadMark:Qr,load:G,getSprite:Ue,getSound:Me,getFont:Yr,getBitmapFont:Pe,getShader:De,Asset:F,SpriteData:S,SoundData:R,width:Q,height:Y,center:we,dt:Z,time:Ae,screenshot:_e,record:pr,isFocused:ji,setCursor:$e,setFullscreen:oi,isFullscreen:fe,isTouch:()=>u.isTouch,onLoad:_t,onLoading:rn,onResize:nn,onError:sn,camPos:ai,camScale:ui,camRot:li,shake:hi,toScreen:tr,toWorld:er,gravity:vi,add:$t,make:pe,destroy:Wi,destroyAll:Zn,get:_n,getAll:Xi,readd:Xn,pos:Xt,scale:Zt,rotate:bi,color:Si,opacity:Ri,origin:me,area:Ii,sprite:Ve,text:Ui,rect:Mi,circle:Di,uvquad:Pi,outline:ki,body:Li,shader:Ni,timer:dr,fixed:Gi,stay:cr,health:Qi,lifespan:Yi,z:Bi,move:Ci,outview:hr,cleanup:Ti,follow:Fi,state:Ki,on:Wt,onUpdate:ge,onDraw:di,onCollide:ci,onClick:Ai,onHover:fi,onKeyDown:nr,onKeyPress:nt,onKeyPressRepeat:sr,onKeyRelease:or,onMouseDown:gi,onMousePress:ar,onMouseRelease:mi,onMouseMove:Vi,onCharInput:wi,onTouchStart:Ei,onTouchMove:yi,onTouchEnd:xi,mousePos:it,mouseDeltaPos:je,isKeyDown:Ze,isKeyPressed:jt,isKeyPressedRepeat:Xe,isKeyReleased:ce,isMouseDown:he,isMousePressed:Ht,isMouseReleased:de,isMouseMoved:We,loop:pi,wait:ir,play:Ut,volume:Or,burp:Ne,audioCtx:B.ctx,Timer:re,Line:Ct,Rect:J,Circle:Se,Polygon:se,Point:Tt,Vec2:L,Color:I,Mat4:P,Quad:O,RNG:Tr,rand:ne,randi:Ir,randSeed:Fn,vec2:g,rgb:T,hsl2rgb:us,quad:Bn,choose:Tn,chance:Cn,lerp:ie,map:Fe,mapc:Rn,wave:vr,deg2rad:Et,rad2deg:Fr,testLineLine:qt,testRectRect:Un,testRectLine:Pn,testRectPoint:Ce,drawSprite:Ge,drawText:He,formatText:Vt,drawRect:rt,drawLine:Pt,drawLines:Qe,drawTriangle:Ye,drawCircle:Dt,drawEllipse:Ke,drawUVQuad:bt,drawPolygon:mt,drawFormattedText:wt,drawMasked:$r,drawSubtracted:ti,pushTransform:et,popTransform:W,pushTranslate:k,pushScale:vt,pushRotate:Hn,pushRotateX:Xr,pushRotateY:Zr,pushRotateZ:gt,pushMatrix:Wr,debug:U,scene:qi,go:Oi,addLevel:Hi,getData:Ji,setData:Ar,download:oe,downloadJSON:Gn,downloadText:Pr,downloadBlob:Sr,plug:fr,ASCII_CHARS:gn,CP437_CHARS:Es,canvas:u.canvas,addKaboom:Zi,LEFT:L.LEFT,RIGHT:L.RIGHT,UP:L.UP,DOWN:L.DOWN,RED:I.RED,GREEN:I.GREEN,BLUE:I.BLUE,YELLOW:I.YELLOW,MAGENTA:I.MAGENTA,CYAN:I.CYAN,WHITE:I.WHITE,BLACK:I.BLACK,quit:on};if(r.plugins&&r.plugins.forEach(fr),r.global!==!1)for(let t in Nt)window[t]=Nt[t];return Nt},"default");Us();function bn(r,a){return center().add(Vec2.fromAngle(r).scale(a))}scene("main",()=>{const r=width()/4;add([pos(center()),origin("center"),rect(width(),height()),color(30,30,40)]).onDraw(()=>{drawCircle({pos:vec2(0,0),radius:r,color:rgb(51,46,65)}),drawCircle({pos:vec2(0,0),radius:r/2,color:rgb(30,30,40)})});const u=-90,l=(r+r/2)/2,w=(r-r/2)*.25,p=[],S=6,R=add([pos(bn(u,l)),area({shape:new Rect(vec2(-w,-w),w*2,w*2)}),circle(w),color(177,227,173),{speed:180,_angle:u,update(){this._angle+=this.speed*dt(),this.pos=bn(this._angle,l)}}]);loop(.08,()=>{p.push(R.pos),p.length>S&&p.shift()}),onDraw(()=>{let C=.5,$=w/4;p.forEach((j,tt)=>{C+=.03,drawCircle({pos:j,radius:$/S*(tt+1),color:rgb(177,227,173),opacity:C})})});function B(){return{spinSpeed:120,update(){this.angle+=this.spinSpeed*dt()}}}function F(){const C=center().x-r,$=center().x+r;return{maxAngle:choose([90,180,270]),startPos:rand(C,$),spinSpeed:120,update(){this.pos.x>this.startPos&&this.angle<this.maxAngle&&(this.angle+=this.spinSpeed*dt())}}}function D(){return{update(){this.angle=wave(-15,15,window.time()*6)}}}function x(){return choose([B(),D(),F()])}const m=120,G=width()/m;loop(G,()=>{let C=0,$=0,j=w*2,tt=j*2.15;const yt=center().y-r,xt=center().y+r;for(let lt=0;lt<2;lt+=1)$=rand(yt,xt),chance(.5)&&([tt,j]=[j,tt]),add([rect(j,tt,{radius:50}),pos(C,$),origin("center"),color(227,140,143),move(RIGHT,120),area(),rotate(0),x(),"obstacle"]),C=C-center().x;add([rect(w,w),pos(C+center().x/2,$),origin("center"),rotate(0),move(RIGHT,120),area(),B(),"bait"])}),onKeyPress("space",()=>{R.speed=-1*R.speed}),onTouchStart(()=>{R.speed=-1*R.speed}),R.onCollide("bait",C=>C.destroy()),R.onCollide("obstacle",C=>{shake(),addKaboom(R.pos)})});go("main");
